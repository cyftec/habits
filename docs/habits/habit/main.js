var JX=(X)=>{let $=Object.entries(X).sort((J,Q)=>J[0].localeCompare(Q[0]));return $.forEach(([J,Q],W)=>{if(Q&&typeof Q==="object"&&!Array.isArray(Q))$[W]=[J,JX(Q)]}),Object.fromEntries($)},WX=(X)=>{if(typeof X!=="object"||X===null||Array.isArray(X))return!1;return Object.prototype.toString.call(X)==="[object Object]"},n=(X)=>{if(Array.isArray(X)){let $=[...X],J=[];return $.forEach((Q)=>{J.push(n(Q))}),J}if(WX(X)){let $={...X},J={};return Object.keys($).forEach((Q)=>{J[Q]=n($[Q])}),Object.freeze(J)}return X},v=(X)=>{if(Array.isArray(X)){let J=[...X],Q=[];return J.forEach((W)=>{Q.push(v(W))}),Q}if(WX(X)){let J={...X},Q={};return Object.keys(J).forEach((W)=>{Q[W]=v(J[W])}),Q}return X},_X=(X,$="index")=>X.map((J,Q)=>({[$]:Q,value:J})),eX=(X,$)=>{let J=JX(X),Q=JX($),W=Object.keys(J),Y=Object.keys(Q);if(W.length!==Y.length)return!1;for(let z of W)if(!Y.includes(z)||!zX(J[z],Q[z]))return!1;return!0},X0=(X,$)=>{if(X.length!==$.length)return!1;if(X.length===0)return!0;for(let J=0;J<X.length;J++)if(!zX(X[J],$[J]))return!1;return!0},zX=(X,$)=>{if(typeof X!==typeof $)return!1;if(Array.isArray(X))return X0(X,$);if(X===null||$===null)return X===$;if(typeof X==="object"&&!(X instanceof Set))return eX(X,$);if(typeof X==="bigint"||typeof X==="number"||typeof X==="string"||typeof X==="boolean")return X===$;return X===$},$0=(X,$,J)=>{let W=_X(v(X),"index");return _X(v($),"index").map((z)=>{let U="add",B=-1,F=z.value;return W.some((_,H)=>{if(U=zX(_.value,z.value)?_.index===z.index?"idle":"shuffle":J&&_.value[J]!==void 0&&_.value[J]===z.value[J]?"update":"add",U!=="add")return B=_.index,W.splice(H,1),!0;return!1}),{type:U,oldIndex:B,value:F}})},I=(X)=>["source-signal","derived-signal"].includes(X?.type),VX=(X,$)=>X?.type==="non-signal"&&(!$||!$.length||$.some((J)=>typeof X?.value===J)),YX=(X)=>I(X)||VX(X),TX=(X)=>VX(X,["string"]),kX=(X)=>X?.type==="non-signal"&&Array.isArray(X?.value)&&(X?.value).every(($)=>typeof $==="string"),h=(X)=>YX(X)?X.value:X,i=null,T=(X)=>{let $=n(X),J=new Set;return{type:"source-signal",get value(){if(i)J.add(i);return v($)},set value(Q){if(Q===$)return;$=n(Q),J.forEach((W)=>W&&W())}}},y=(X)=>{i=X,X(),i=null},q=(X)=>{let $,J=T($);return y(()=>{$=X($),J.value=$}),{type:"derived-signal",get prevValue(){return $},get value(){return J.value}}},LX=(X)=>{if(!WX(X.value))throw new Error("Thee argument should be a plain object or a signal of plain object");return{prop:($)=>q(()=>X.value[$]),get props(){return Object.keys(X.value).reduce((J,Q)=>{let W=Q;return J[W]=this.prop(W),J},{})}}},R=(X,...$)=>q(()=>{return X.reduce((J,Q,W)=>{let Y,z=$[W];if(typeof z==="function")Y=z()??"";else if(YX(z))Y=z.value??"";else Y=z??"";return`${J}${Q}${Y.toString()}`},"")}),MX=["onmount","onunmount"],EX=["onerror","onload","onresize","onblur","onchange","oncontextmenu","onfocus","oninput","oninvalid","onreset","onselect","onsubmit","onkeydown","onkeypress","onkeyup","onclick","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onscroll","onabort","oncanplay","oncanplaythrough","ondurationchange","onemptied","onended","onerror","onloadeddata","onloadedmetadata","onloadstart","onpause","onplay","onplaying","onprogress","onratechange","onseeked","onseeking","onstalled","onsuspend","ontimeupdate","onvolumechange","onwaiting"],J0=[...EX,...MX],Q0=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],s,Z0=(X)=>{if(!s)s=document.createElement("textarea");return s.innerHTML=X,s.value},W0=()=>{let X=0;return{getNewId:()=>++X,resetIdCounter:()=>X=0}},OX=W0(),x={currentIs:(X)=>window._currentAppPhase===X,start:(X)=>{window._currentAppPhase=X,console.log(`Current phase is ${X}`)}},l=(X)=>Array.isArray(X),a=(X)=>!isNaN(X?.elementId)&&X?.elementId>0,b=(X)=>typeof X==="string"||typeof X==="function"&&X.isElementGetter,UX=(X)=>I(X)&&b(X.value),z0=(X)=>b(X)||UX(X),SX=(X)=>{return I(X)&&(b(X.value)||l(X.value)&&X.value.every(($)=>b($)))},xX=(X)=>{return!I(X)&&(TX(X)||kX(X)||b(X)||l(X)&&X.every(($)=>z0($)))},qX=(X)=>{return SX(X)||xX(X)},RX=!1,Y0={},g={},U0=globalThis.MutationObserver,q0=new U0((X)=>{X.forEach(($)=>{if($.type==="childList")$.addedNodes.forEach((J)=>{if(a(J)){let Q=J,W=Q.elementId;if(g[W])delete g[W];else Y0[W]=Q.tagName}}),$.removedNodes.forEach((J)=>{if(a(J)){let Q=J,W=Q.elementId,Y=Q.unmountListener;if(Y)g[W]={element:Q,unmountListener:Y}}})}),Object.entries(g).forEach(([$,J])=>{let{element:Q,unmountListener:W}=J;NX(Q,W)})}),NX=(X,$)=>{if(!a(X))return;let J=X.children;for(let Q=0;Q<J.length;Q++){let W=J[Q];NX(W,W.unmountListener)}if($&&$(X),g[X.elementId])delete g[X.elementId]},G0=()=>{if(!RX&&!x.currentIs("build"))q0.observe(document.body,{childList:!0,subtree:!0}),RX=!0},CX=(X,$)=>J0.includes(X)&&$===void 0,IX=(X,$)=>EX.includes(X)&&typeof $==="function",gX=(X,$)=>MX.includes(X)&&typeof $==="function",B0=(X,$)=>CX(X,$)||IX(X,$)||gX(X,$),_0=(X,$)=>{Object.entries($).forEach(([J,Q])=>{if(CX(J,Q));else if(IX(J,Q)){let W=J.slice(2);X.addEventListener(W,(Y)=>{if(W==="keypress")Y.preventDefault();Q(Y)})}else if(gX(J,Q)){if(J==="onmount"&&!x.currentIs("build")){let W=Q;setTimeout(()=>W(X),0)}if(J==="onunmount")G0(),X.unmountListener=Q}else console.error(`Invalid event key: ${J} for element with tagName: ${X.tagName}`)})},FX=(X,$,J)=>{let Q=(YX(J)?J.value:J)??"";if(typeof Q==="boolean")if(Q)X.setAttribute($,"");else X.removeAttribute($);else if($==="value")X.value=Q;else if(Q)X.setAttribute($,Q)},R0=(X,$)=>{let J={};Object.entries($).forEach((Q)=>{let[W,Y]=Q;if(I(Y))J[W]=Y;FX(X,W,Y)}),y(()=>{Object.entries(J).forEach((Q)=>{let[W,Y]=Q,z=Y.value;if(!x.currentIs("run"))return;FX(X,W,z)})})},r=(X)=>{if(UX(X)){let $=X.value;return r($)}if(typeof X==="string")return document.createTextNode(Z0(X));if(b(X)){let $=X();if(!a($))throw new Error(`Invalid MHtml element getter child. Type: ${typeof X}`);return $}throw new Error(`Invalid child. Type of child: ${typeof X}`)},F0=(X,$)=>{if(!$)return;if(SX($))y(()=>{let Q=$.value,W=l(Q)?Q:[Q];W.forEach((z,U)=>{let B=X.childNodes[U],F=r(z);if(B&&F)X.replaceChild(F,B);else if(F)X.appendChild(F);else console.error(`No child found for node with tagName: ${X.tagName}`)});let Y=W.length;while(Y<X.childNodes.length){let z=X.childNodes[Y];if(z)X.removeChild(z)}});if(xX($)){let J=TX($)?[$.value]:kX($)?$.value:l($)?$:[$],Q=[];if(J.forEach((W,Y)=>{if(UX(W))Q.push({index:Y,childSignal:W});let z=r(W),U=X.childNodes[Y];if(U&&z)X.replaceChild(z,U);else if(!U&&z)X.appendChild(z);else console.error(`No child found for node with tagName: ${X.tagName}`)}),Q.length)Q.forEach(({index:W,childSignal:Y})=>{y(()=>{if(!Y.value)return;if(!x.currentIs("run"))return;let z=r(Y.value),U=X.childNodes[W];if(U&&z)X.replaceChild(z,U);else if(!U&&z)X.appendChild(z);else console.error(`No child found for node with tagName: ${X.tagName}`)})})}},P0=(X,$)=>{let J=void 0,Q={},W={};return Object.entries(X).forEach(([Y,z])=>{if(Y==="children")if(qX(z))J=z;else if(z===void 0)J=z;else throw new Error(`Invalid children prop for node with tagName: ${$}

 ${JSON.stringify(z)}`);else if(B0(Y,z))Q[Y]=z;else W[Y]=z}),{children:J,eventProps:Q,attributeProps:W}},j0=(X,$)=>{let J=()=>{let Q=OX.getNewId(),W=x.currentIs("mount")?document.querySelector(`[data-elem-id="${Q}"]`):document.createElement(X);W.elementId=Q,W.unmountListener=void 0;let Y=qX($)?{children:$}:$;if(!x.currentIs("run"))Y["data-elem-id"]=W.elementId.toString();let z=P0(Y,W.tagName);if(_0(W,z.eventProps),R0(W,z.attributeProps),F0(W,z.children),!x.currentIs("build"))W.removeAttribute("data-elem-id");return W};return J.isElementGetter=!0,J},PX=(X,$,J)=>{let Q=T($),W=T(X),Y=J(q(()=>W.value),q(()=>Q.value)),z,U,B=!1;if(Y?.isElementGetter)z=()=>{if(B&&U)return U;return U=Y(),B=!0,U},z.isElementGetter=!0;else if(typeof Y==="string")z=Y;else throw`One of the child, ${Y} passed in ForElement is invalid.`;return{indexSignal:Q,itemSignal:W,mappedChild:z}},jX=(X,$,J)=>{if($!==void 0&&$>=0&&J){let Q=$>X.length?X.length:$;X.splice(Q,0,J)}return X},K0=({subject:X,itemKey:$,map:J,n:Q,nthChild:W})=>{if(W&&Q===void 0||Q!==void 0&&Q>-1&&!W)throw new Error("Either both 'n' and 'nthChild' be passed or none of them.");let Y=q(()=>{let j=h(X);return Array.isArray(j)?j:[]});if(!$)return q(()=>jX(Y.value.map(J),Q,W));let z=W;if(W&&typeof W!=="string"){let j=W(),D=()=>j;D.isElementGetter=!0,z=D}let U=Y.value;if(U.length&&typeof U[0]!=="object")throw new Error("for mutable map, item in the list must be an object");let B=null,F=q((j)=>{return B=j||B,Y.value}),_=q((j)=>{if(!j||!B)return F.value.map((L,V)=>PX(L,V,J));return $0(B,F.value,$).map((w,L)=>{let V=(j||[])[w.oldIndex];if(console.assert(w.type==="add"&&w.oldIndex===-1&&!V||w.oldIndex>-1&&!!V,"In case of mutation type 'add' oldIndex should be '-1', or else oldIndex should always be a non-negative integer."),V){if(w.type==="shuffle")V.indexSignal.value=L;if(w.type==="update")V.indexSignal.value=L,V.itemSignal.value={...w.value};return V}return PX(w.value,L,J)})});return q(()=>jX(_.value.map((j)=>j.mappedChild),Q,z))},H0=({subject:X,isTruthy:$,isFalsy:J})=>{let Q=Z.Span({style:"display: none;"}),W=()=>(h(X)?$:J)||Q;return I(X)?q(W):W()},D0=({subject:X,caseMatcher:$,defaultCase:J,cases:Q})=>{let W=()=>{let Y=h(X),z=void 0;for(let[U,B]of Object.entries(Q))if($&&$(X,U)||Y===U){z=B;break}return z||J||Z.Span({style:"display: none;"})};return I(X)?q(W):W()},f0=Q0.reduce((X,$)=>{let J=$.split("").map((W,Y)=>!Y?W.toUpperCase():W).join(""),Q=(W)=>j0($,W);return X[J]=Q,X},{}),w0={For:K0,If:H0,Switch:D0},Z={...f0,...w0},A=(X)=>($)=>{for(let Q of Object.keys($))if($[Q]===void 0)delete $[Q];let J=Object.entries($).reduce((Q,W)=>{let[Y,z]=W,U=typeof z==="string",B=Array.isArray(z)&&z.every((_)=>typeof _==="string"),F=I(z)||typeof z==="function"?z:U||B?{type:"non-signal",get value(){return h(z)}}:qX(z)?z:{type:"non-signal",get value(){return h(z)}};return Q[Y]=F,Q},{});return X(J)},yX=86400000,A0=1.6181,bX={id:"local-settings",habitsPage:{tabIndex:0,sortOptionIndex:0}},KX=[{icon:"calendar_month",decending:!0,label:"Date created (Newest first)"},{icon:"calendar_month",decending:!1,label:"Date created (Oldest first)"},{icon:"task_alt",decending:!0,label:"Completion (Highest first)"},{icon:"task_alt",decending:!1,label:"Completion (Lowest first)"}],V0=[1,1,1,1,1,1,1],T0=["Not done","Done"],k0=[90,75,50],L0=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],cX=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],vX=["January","February","March","April","May","June","July","August","September","October","November","December"],hX=["#e87b52","#F5B971","#F5E06F","#A3BA64","#679A9E","#7095C9","#A59EE3","#D89DBF"],M0=(X)=>{let $=new Date().getTime();return{id:X?$-yX*X:$,title:"",frequency:V0,colorIndex:0,levels:T0,tracker:[],milestones:k0,pauses:[],isStopped:!1}},uX=(X)=>[{label:"Successful",percent:X[0],icon:"verified_user",color:"green"},{label:"Little more to go",percent:X[1],icon:"done_all",color:"light-blue"},{label:"Going good",percent:X[2],icon:"check",color:"blue"},{label:"Unacceptable",percent:0,icon:"close",color:"red"}],QX=(X,$)=>{let J=uX(X),Q=J[0];for(let W=0;W<J.length;W++)if(Q=J[W],Q.percent<$)break;return Q},E0=(X)=>{if(!X.title)return"Title should not be empty";if(X.frequency.every(($)=>!$))return"Select at least one day in a week";if(!X.levels.every(($)=>!!$))return"One of the levels is empty";if(!X.milestones.every(($)=>$<=100&&$>=0))return"The milestones should be between 0 and 100 percents";if(!X.milestones.every(($,J,Q)=>J===0?!0:Q[J-1]>$))return"Milestones should be in order (from high to low)";return""},O0=()=>{if(!location)return[];return location.href.split("?")[1].split("&")},HX=(X)=>{return new Date(X.getFullYear(),X.getMonth(),X.getDate())},S0=(X,$)=>{let{id:J,tracker:Q}=X,W=$.getFullYear(),Y=$.getMonth(),z=[...L0],U=new Date(J),B=U.getFullYear(),F=U.getMonth(),_=U.getDate();for(let H=0;H<Q.length;H++){let j=new Date(B,F,_+H),D=j.getFullYear(),w=j.getMonth();if(D>W)break;if(D===W&&w>Y)break;if(D===W&&w===Y){let L=j.getDate();z[L-1]=Q[H]}}return z},pX=(X,$)=>{let J=new Date;return Array($).fill(0).map((W,Y)=>new Date(J.getFullYear(),J.getMonth()-Y,1)).reverse().map((W)=>({monthIndex:W.getMonth(),status:S0(X,W)}))},mX=(X,$)=>{let J=HX(X),Q=HX($);return Math.round((Q.getTime()-J.getTime())/yX)},x0=(X,$)=>{let J=pX(X,$),Q=X.levels.length-1,W=0,Y=0;for(let z of J)for(let U of z.status)if(U>-1)Y++,W+=U;return Math.ceil(W/(Y*Q)*100)},k=(X)=>{return(...$)=>{if(window.navigator?.vibrate)window.navigator.vibrate(3);return X&&X(...$)}},N0=(X)=>{let $=localStorage.getItem(X),J=JSON.parse($||"");if(!J)throw`Error fetching habit with id '${X}' from storage`;return J},C0=()=>{for(let X in localStorage){if(!X.startsWith("h."))continue;let $=JSON.parse(localStorage.getItem(X)||"{}");if(typeof $!=="object"||!$.title)continue;let J=`h.${$.id}`,Q=new Date($.id),Y=mX(Q,new Date),z=[...$.tracker];if(Y+1<=z.length)continue;for(let U=z.length;U<=Y;U++){let F=new Date(Q.getFullYear(),Q.getMonth(),Q.getDate()+U).getDay();z[U]=$.frequency[F]?0:-1}$.tracker=z,localStorage.setItem(J,JSON.stringify($))}},sX=(X,$)=>{localStorage.setItem(X,JSON.stringify($))},rX=()=>{let X=O0();if(!X.length);let $,J="";for(let Q of X){if(!Q.startsWith("id="))continue;let Y=+(Q.split("id=").pop()||"__");if(!Y||isNaN(Y))continue;let z=`h.${Y}`;try{$=N0(z)}catch(U){J=U.toString()}}return[$,J]},I0=()=>{localStorage.setItem("settings",JSON.stringify(bX))},g0=()=>{if(!globalThis.localStorage)return bX;let X=localStorage.getItem("settings")||"{}",$=JSON.parse(X);if(!(typeof $==="object"&&$.id==="local-settings"))I0();return JSON.parse(localStorage.getItem("settings"))},y0=T(g0());y(()=>{let X=y0.value;if(globalThis.localStorage)localStorage.setItem("settings",JSON.stringify(X))});var b0=A(({classNames:X,hideRemove:$,hideAdd:J,onRemove:Q,onAdd:W})=>{return Z.Span({class:R`br3 pb1 f4 bw1 b--light-silver dark-gray ${()=>$?.value&&J?.value?"bn":"ba"} ${X}`,children:[Z.If({subject:$,isFalsy:Z.Span({class:R`pointer ph2 pb1 bw1 b--light-silver ${()=>J?.value?"":"br"}`,onclick:k(Q),children:"-"})}),Z.If({subject:J,isFalsy:Z.Span({class:"pointer ph2 pb1",onclick:k(W),children:"+"})})]})}),O=A(({className:X,onTap:$,children:J})=>Z.Button({class:R`pointer br-pill ba bw1 b--light-silver b--hover-black bg-white black ${X}`,onclick:k(()=>$()),children:J})),GX=A(({classNames:X,colorIndex:$,level:J,totalLevels:Q,textContent:W,showText:Y,onClick:z})=>{let U=q(()=>hX[$.value]),B=q(()=>Math.trunc(Math.pow(J.value/(Q.value-1),A0)*255)),F=q(()=>{let j=B.value.toString(16);return j.length===1?`0${j}`:j}),_=q(()=>J.value<0||F.value==="0"?"transparent":`${U.value}${F.value}`),H=q(()=>Y?.value?J.value/(Q.value-1)>0.5?"white":"black":J.value<0?"lightgray":"transparent");return Z.Span({class:R`pointer br-100 relative ${()=>J.value<0?"transparent":"bg-near-white"} ${X}`,onclick:k(()=>z&&J.value>=0&&z()),children:[Z.Span({class:R`flex items-center justify-around absolute absolute--fill br-100 pt05`,style:R`
            background-color: ${_};
            color: ${H};
          `,children:q(()=>W?.value||"Î‡")})]})}),C=A(({className:X,size:$,onClick:J,iconName:Q,title:W})=>Z.Span({class:R`material-symbols-rounded ${()=>J?"pointer":""} ${X}`,style:R`font-size: ${()=>$?.value||"16"}px`,onclick:k(J),children:Q,title:W})),DX=A(({classNames:X,href:$,target:J,onClick:Q,children:W})=>{return Z.A({class:R`${()=>!$&&!Q?"":"pointer underline"} ${X}`,href:$,target:J,onclick:k(Q),children:W})}),u=A(({classNames:X,isOpen:$,content:J,onTapOutside:Q})=>{return Z.Dialog({onmount:(W)=>setTimeout(()=>y(()=>{if($.value)W.showModal();else W.close()})),onclick:k(Q),class:R`pa0 br3 ${X}`,children:[Z.Div({onclick:(W)=>W.stopPropagation(),children:J})]})}),c0=A(({classNames:X,placeholder:$,num:J,onchange:Q})=>{let W=(Y)=>{let z=Y.target.value,U=Number.parseFloat(Number.parseFloat(z||"0").toFixed(2));Q(U)};return Z.Input({class:X,type:"number",placeholder:$,value:R`${()=>J.value??""}`,onchange:W})}),oX=A(({classNames:X,body:$,onMount:J})=>{return Z.Html({lang:"en",children:[Z.Head({children:[Z.Title("Maya App"),Z.Meta({charset:"UTF-8"}),Z.Meta({"http-equiv":"X-UA-Compatible",content:"IE=edge"}),Z.Meta({name:"viewport",content:"width=device-width, initial-scale=1.0"}),Z.Link({rel:"stylesheet",href:"/assets/styles.css"})]}),Z.Body({class:X,onmount:J,children:[Z.Script({src:"main.js",defer:"true"}),$]})]})}),o0=A(({progress:X,classNames:$})=>{let J=R`width: ${()=>X.value<0?0:X.value>100?100:X.value}%;`;return Z.Div({class:R`br-pill bg-moon-gray ${$}`,children:Z.Div({class:"br-pill bg-app-theme-color pa1",style:J})})}),dX=A(({classNames:X,header:$,content:J,bottombar:Q})=>{return Z.Div({class:"flex-ns justify-center-ns",children:Z.Div({class:R`w6-ns ${X}`,children:[Z.If({subject:$,isTruthy:Z.Div({class:"overflow-break-word sticky top-0 left-0 right-0 bg-inherit z-999 f2dot33 b pv3 mt2",children:$})}),J,Z.Div({class:"pv6 mt5"}),Z.If({subject:Q,isTruthy:Z.Div({class:"sticky bottom-0 left-0 right-0 z-9999",children:Q})})]})})}),d0=A(({classNames:X,tabItemClassNames:$,selectedTabClassNames:J,tabs:Q,selectedTabIndex:W,onTabChange:Y})=>{return Z.Div({class:R`bg-near-white br3 ${X}`,children:Z.Div({class:"flex items-center justify-between pa1",children:Z.For({subject:Q,map:(z,U)=>Z.Span({class:R`w-100 br3 pa1 flex justify-center ${()=>U===W.value?`bg-white black ${J?.value}`:"bg-transparent silver pointer"} ${$}`,onclick:k(()=>Y(U)),children:z})})})})}),fX=A(({classNames:X,placeholder:$,disabled:J,text:Q,onmount:W,onchange:Y,onkeydown:z,onfocus:U,onblur:B})=>{let F,_=(D)=>{if(F=D,W)W(D)},H=(D)=>{let w=D.target.value;if(Y)Y(w)},j=(D)=>{let w=D.key.length===1?F.value+D.key:D.key==="Backspace"?F.value.slice(0,-1):F.value,L={key:D.key,text:w};if(z)z(L)};return Z.Input({onmount:_,class:R`${X}`,type:"text",placeholder:$,disabled:J,value:Q,onchange:H,onkeydown:j,onfocus:U,onblur:B})}),v0=A(({classNames:X,status:$,month:J,colorIndex:Q,totalLevels:W})=>{return Z.Div({class:R`flex items-center ${X}`,children:[Z.Div({class:"f8 b w1 light-silver",children:q(()=>J.value.charAt(0))}),Z.Div({class:"w-100 flex items-center justify-between",children:Z.For({subject:$,map:(Y)=>GX({classNames:"pa1",colorIndex:Q,level:Y,totalLevels:W})})})]})}),n0=A(({classNames:X,habit:$,months:J,onClick:Q})=>{let{milestones:W,title:Y,completion:z,colorIndex:U,levels:B}=LX(q(()=>$.value)).props,F=q(()=>pX($.value,J.value)),_=q(()=>QX(W.value,z.value).icon),H=q(()=>QX(W.value,z.value).color);return Z.Div({class:R`pointer bg-white br4 pa3 ${X}`,onclick:k(Q),children:[Z.Div({class:"flex items-center justify-between nt1 mb2",children:[Z.Div({class:"f4 dark-gray b",children:Y}),Z.Div({class:"f6 silver b flex items-center",children:[C({className:R`mr1 ${H}`,iconName:_}),R`${z}%`]})]}),Z.Div({class:"mt3 mb1",children:Z.For({subject:F,map:(j)=>v0({classNames:"mb1",month:vX[j.monthIndex],status:j.status,colorIndex:U,totalLevels:B.value.length})})})]})}),h0=A(({classNames:X,habit:$,initialLevels:J,onChange:Q})=>{let{title:W,frequency:Y,levels:z,milestones:U,colorIndex:B}=LX($).props,F=q(()=>Y.value.every((G)=>!!G)),_="bg-mid-gray white",H="bg-near-white light-silver",j=(G)=>{Q({...$.value,title:G})},D=(G)=>{Q({...$.value,colorIndex:G})},w=(G)=>{if(G<-1||G>6)throw"Invalid day index";if(G===-1){Q({...$.value,frequency:[1,1,1,1,1,1,1]});return}let P=F.value?Y.value.map((f)=>0):Y.value;P[G]=F.value?1:P[G]?0:1,Q({...$.value,frequency:P})},L=(G,P)=>{let f=z.value;f[P]=G,Q({...$.value,levels:f})},V=(G,P=!0)=>{let f=z.value;if(P)f.splice(G,0,"");else f.splice(G,1);Q({...$.value,levels:f})},E=(G)=>V(G),M=(G)=>{if(z.value.length<3)return;V(G,!1)},S=(G,P)=>{if(P<0||P>2)throw"Incorrect index of milestone passed. Milestone values should not be more than 3.";let f=[...$.value.milestones];f[P]=G,Q({...$.value,milestones:f})};return Z.Div({class:X,children:[N({title:"Color",child:Z.Div({class:"mb1 flex items-center justify-between justify-start-ns",children:Z.For({subject:hX,map:(G,P)=>{let f=q(()=>P===B.value?"#999":"#f4f4f4");return Z.Span({class:"pointer mb2 mr3-ns pa1 br-100 bw2 ba flex",style:R`border-color: ${f}`,onclick:k(()=>D(P)),children:Z.Span({class:R`pa2 br-100`,style:`background-color: ${G}`})})}})})}),N({classNames:"pb1",title:"Title",child:fX({classNames:"ba bw1 b--light-silver br3 pa2 w-100",placeholder:"title of target habit",text:W,onchange:j})}),N({classNames:"pb1",title:"Frequency",child:Z.Div({class:"mb3 f6 flex items-center justify-between justify-start-ns",children:Z.For({subject:cX,n:0,nthChild:Z.Span({class:R`pointer flex items-center justify-center br-pill h2 ph2 mr3-ns ${()=>F.value?"bg-mid-gray white":"bg-near-white light-silver"}`,children:"Daily",onclick:k(()=>w(-1))}),map:(G,P)=>{let f=q(()=>Y.value[P]&&!F.value?"bg-mid-gray white":"bg-near-white light-silver");return Z.Span({class:R`pointer flex items-center justify-center br-100 h2 w2 mr3-ns ${f}`,children:G.charAt(0),onclick:k(()=>w(P))})}})})}),N({classNames:"pb3",title:"Levels",child:Z.Div({children:Z.For({subject:z,map:(G,P)=>{let f=$.value.levels.length<3,p=!!(J.value.length&&J.value.includes(G)),t=!!(J.value.length&&J.value.length!==$.value.levels.length),m=$.value.levels.length<J.value.length,BX=J.value.length&&!t&&!J.value.every((e,tX)=>e===$.value.levels[tX]),iX=m||BX||t&&m&&p,lX=f||m||BX||t&&!m&&p,aX=J.value.length!==$.value.levels.length&&J.value.includes(G);return Z.Div({children:[Z.Div({class:"flex items-center justify-between",children:[Z.Div({class:"flex items-center w-80-ns",children:[GX({classNames:"pa2 mr2",colorIndex:B,level:P,totalLevels:z.value.length}),fX({classNames:"ba bw1 b--light-silver br3 pa2 w-100",placeholder:`Level ${P}`,disabled:aX,text:G,onchange:(e)=>L(e,P)})]}),b0({hideAdd:iX,hideRemove:lX,onAdd:()=>E(P+1),onRemove:()=>M(P)})]}),Z.If({subject:P<z.value.length-1,isTruthy:Z.Div({class:"pa2 ml2 bl bw1 b--light-gray"})})]})}})})}),N({title:"Milestones",child:Z.Div({children:Z.For({subject:q(()=>uX(U.value)),n:0,nthChild:Z.Div({class:"mb1 ph2 pv0 bn bw1 relative ts-white-1",children:[Z.Span({class:"lh-copy",children:""}),Z.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[Z.Span({class:"w-100 bg-white bn bw1 pa2dot5 di f4 b light-silver mb1 nl1",children:"100"}),Z.Span({class:"ph2 bg-white light-silver b mr1",children:"%"})]})]}),map:(G,P)=>Z.Div({class:"mb1 ph4 pv4 ba br3 bw1 b--light-gray relative",children:[Z.Span({class:"lh-copy flex items-center",children:[C({className:`mr2 ${G.color}`,size:20,iconName:G.icon}),G.label]}),Z.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[Z.If({subject:P===3,isTruthy:Z.Span({class:"w-100 bg-white bn bw1 br3 pa2dot5 di f4 b light-silver mb1",children:"00"}),isFalsy:c0({classNames:"w-100 ba bw1 b--light-silver br3 pa2dot5 di f5 b dark-gray",num:G.percent,onchange:(f)=>S(f,P)})}),Z.Span({class:"ph2 bg-white light-silver b",children:"%"})]})]})})})})]})}),i0=A(({isNew:X})=>{let $=T(!1),J=T(!1),Q=T(""),W=T(M0()),Y=T([]),z=q(()=>X.value?"New target habit":`Edit '${W.value.title}'`),U=()=>{if(Q.value=E0(W.value),Q.value)return;let _=W.value,H=[...Y.value],j=`h.${_.id}`,D=[..._.tracker],w=!!(!X.value&&H.length&&H.length!==_.levels.length),L=_.levels.length<H.length;if(w){let V=[];if(!L)H.forEach((E,M)=>{let S=_.levels.indexOf(E);if(S>-1&&S!==M){let P=[];_.tracker.forEach((f,p)=>{if(f===M)P.push(p)}),V.push({indices:P,newValue:S})}});else{let E=-1;for(let M=0;M<H.length;M++)if(H[M]!==_.levels[M]){E=M;break}if(E>=0)H.forEach((M,S)=>{if(S<=E)return;let G=[];_.tracker.forEach((P,f)=>{if(P===S)G.push(f)}),V.push({indices:G,newValue:S-1})})}V.forEach((E)=>{E.indices.forEach((M)=>{D[M]=E.newValue})})}sX(j,{...W.value,tracker:D}),B()},B=()=>{location.href=X.value?"/habits/":`/habits/habit/?id=${W.value.id}`};return oX({onMount:()=>{if(X.value)return;let[_,H]=rX();if(H||!_){Q.value=H||"Error fetching habit from 'id' given in query params";return}if(W.value=_,!X.value)Y.value=_.levels},body:dX({classNames:"bg-white ph3",header:Z.Div({class:R`${()=>z.value.length>22?"f2dot66":""}`,children:z}),content:Z.Div([Z.If({subject:X,isFalsy:Z.Div({class:"",children:[N({classNames:"pb2",title:"Actions",child:Z.Div({children:[u({classNames:"bn",isOpen:$,onTapOutside:()=>$.value=!1,content:Z.Div({class:"pa3 f5",children:[Z.Div({class:"mb3 b f4",children:R`Delete '${()=>W.value.title}'?`}),Z.Div({class:"mb4",children:[`
                              All the data and the acheivements associated with this habit will be lost forever
                              with this action, and cannot be reversed.
                              `,Z.Br({}),Z.Br({}),`
                              Are you sure, you want to DELETE this habit permanently?
                              `]}),Z.Div({class:"flex items-center justify-between f6",children:[O({className:"w-25 pv2 ph3 mr1 b",children:"No",onTap:()=>$.value=!1}),O({className:"pv2 ph3 ml2 b red",children:"Yes, delete permanently",onTap:()=>{let _=`h.${W.value.id}`;localStorage.removeItem(_),$.value=!1,location.href="/habits/"}})]})]})}),DX({classNames:"db mb3 f6 red",children:"Delete this habit permanently along with its data",onClick:()=>$.value=!0}),u({classNames:"bn",isOpen:J,onTapOutside:()=>J.value=!1,content:Z.Div({class:"pa3 f5",children:[Z.Div({class:"mb3 b f4",children:R`Stop '${()=>W.value.title}'?`}),Z.Div({class:"mb4",children:[`
                              This action is not reversible. You will not be able to resume it again.`,Z.Br({}),Z.Br({}),`
                              Are you sure, you want to STOP this habit permanently?
                              `]}),Z.Div({class:"flex items-center justify-between f6",children:[O({className:"w-100 pv2 ph3 mr2",children:"No, go back",onTap:()=>J.value=!1}),O({className:"w-100 pv2 ph3 ml2 b",children:"Yes, stop this",onTap:()=>{W.value={...W.value,isStopped:!0},U(),J.value=!1}})]})]})}),DX({classNames:"db mb3 f6 gray",children:"Stop this habit permanently and keep it for review in future",onClick:()=>J.value=!0})]})})]})}),h0({habit:W,initialLevels:Y,onChange:(_)=>W.value=_})]),bottombar:Z.Div({class:"bg-white w-100 pv3",children:[Z.If({subject:Q,isTruthy:Z.Div({class:"red mb3",children:Q})}),Z.Div({class:"flex items-center justify-stretch",children:[O({className:"w4dot50 w4dot25-ns pa3 flex items-center",children:[C({iconName:"arrow_back"}),Z.Span({class:"ml1",children:"Go Back"})],onTap:B}),O({className:"w-100 pa3 ml3 b",children:q(()=>X.value?"Save":"Update"),onTap:U})]})]})})})}),N=A(({classNames:X,title:$,child:J})=>{return Z.Div({class:R`mt3 mb4 ${X}`,children:[Z.Div({class:"mb2 dark-gray f4 b",children:$}),Z.Div(J)]})}),l0=A(({classNames:X,iconSize:$,selectedOptionIndex:J,onChange:Q})=>{let W=T(!1),Y=q(()=>KX[J.value]),z=(U)=>{Q(U),W.value=!1};return Z.Div({class:X,children:[wX({classNames:"pointer",descending:q(()=>Y.value.decending),iconName:q(()=>Y.value.icon),size:q(()=>$?.value??20),onClick:()=>W.value=!0}),u({classNames:"f5 normal ba bw0 outline-0",isOpen:W,onTapOutside:()=>W.value=!1,content:Z.Div({children:[Z.Div({class:"f5 b tc pv3",children:"Sort habit cards by"}),Z.Div({class:"f5 mb1",children:Z.For({subject:KX,map:(U,B)=>{let F=R`pointer flex items-center pv3 pl2 pr3 bt b--moon-gray ${()=>U.label===Y.value.label?"bg-near-white black":"gray"}`;return Z.Div({class:F,onclick:k(()=>z(B)),children:[wX({classNames:"ml1 mr2",descending:U.decending,iconName:U.icon,size:20}),Z.Span(U.label)]})}})})]})})]})}),wX=A(({classNames:X,descending:$,iconName:J,size:Q,onClick:W})=>{return Z.Span({class:R`flex items-center ${()=>W?"pointer":""} ${X}`,onclick:k(W),children:[C({className:"silver",size:q(()=>4*Q.value/5),iconName:q(()=>$.value?"arrow_upward":"arrow_downward")}),C({className:"",size:Q,iconName:J})]})}),ZX=T(""),K=T(void 0),c=T(!1),o=T(!1),d=T({date:new Date,selectedLevelIndex:0}),AX=q(()=>K.value?K.value.title:"Loading.."),u0=q(()=>{let X=K.value;if(!X)return[];let $=X.levels.map((Y)=>0),J=X.tracker.reduce((Y,z)=>{if(z>-1)Y[z]=Y[z]?Y[z]+1:1;return Y},$),Q=J.reduce((Y,z)=>Y+z);return J.map((Y,z)=>({level:X.levels[z],total:Y,percent:Math.round(100*Y/Q)}))}),nX=q(()=>K.value?x0(K.value,20):0),XX=q(()=>{let X=nX.value,$=K.value;return $?QX($.milestones,X):void 0}),$X=q(()=>{let X=K.value;if(!X)return[];let $=X.id,J=new Date($),Q=J.getDay(),Y=[...X.tracker];Array(Q).fill(void 0).forEach((U)=>Y.unshift(U)),Array(7-Y.length%7).fill(void 0).forEach((U)=>Y.push(U));let z=[];for(let U=0;U<Y.length;U++){let B=Math.floor(U/7);if(!z[B])z[B]=[];z[B][U%7]={level:Y[U],date:new Date(J.getFullYear(),J.getMonth(),J.getDate()-Q+U)}}return z}),p0=(X)=>{if(!K.value)return;let $=[...K.value.tracker],J=mX(new Date(K.value.id),d.value.date);$[J]=X;let Q=`h.${K.value.id}`;K.value={...K.value,tracker:$},sX(Q,K.value),o.value=!1},m0=()=>{C0();let[X,$]=rX();if($||!X){ZX.value=$||"Nohabit found for 'id' in query param";return}K.value=X},s0=oX({onMount:m0,body:dX({classNames:"bg-white ph3",header:Z.Div({class:"flex items-start justify-between",children:[Z.Div({class:R`${()=>AX.value.length>22?"f2dot66":""}`,children:AX}),Z.If({subject:q(()=>K.value?.isStopped),isFalsy:C({className:"mt1 mr1 ba b--silver bw1 br-100 pa1 noselect",size:18,iconName:"edit",onClick:()=>{if(K.value)location.href=`edit/?id=${K.value.id}`}})})]}),content:Z.Div({children:[u({classNames:"bn",isOpen:c,onTapOutside:()=>c.value=!1,content:Z.Div({class:"pa3 f5",children:[Z.Div({class:"mb3 b f4",children:R`Delete '${()=>K.value?.title}'?`}),Z.Div({class:"mb4",children:[`
                  All the data and the acheivements associated with this habit will be lost forever
                  with this action, and cannot be reversed.
                  `,Z.Br({}),Z.Br({}),`
                  Are you sure, you want to DELETE this habit permanently?
                  `]}),Z.Div({class:"flex items-center justify-between f6",children:[O({className:"w-25 pv2 ph3 mr1 b",children:"No",onTap:()=>c.value=!1}),O({className:"pv2 ph3 ml2 b red",children:"Yes, delete permanently",onTap:()=>{let X=`h.${K.value?.id||-1}`;if(X in localStorage)localStorage.removeItem(X);c.value=!1,location.href="/habits/"}})]})]})}),u({classNames:"f5 normal ba bw0 outline-0",isOpen:o,onTapOutside:()=>o.value=!1,content:Z.Div({class:"mnw5",children:[Z.Div({class:"f5 b tc pa3",children:q(()=>d.value.date.toDateString())}),Z.Div({class:"f5 mb1",children:Z.For({subject:q(()=>K.value?.levels||[]),map:(X,$)=>{let J=R`pointer flex items-center pv3 pa3 bt b--moon-gray ${()=>$===d.value.selectedLevelIndex?"bg-near-white black":"gray"}`;return Z.Div({class:J,onclick:k(()=>p0($)),children:[Z.Span(X)]})}})})]})}),Z.If({subject:ZX,isTruthy:Z.Div({class:"red",children:ZX}),isFalsy:Z.Div(Z.If({subject:K,isFalsy:Z.Div({class:"",children:"habit.."}),isTruthy:Z.Div({children:[Z.If({subject:q(()=>!!K.value?.isStopped),isTruthy:Z.Div([Z.Div({class:"red mb3",children:"Status: STOPPED PERMANENTLY"}),O({className:"pv2 ph3 nt2 mb4 red",onTap:()=>c.value=!0,children:"Delete Permanently"})])}),N({classNames:"pb3",title:"Acheivment",child:Z.Div({children:Z.For({subject:u0,n:1/0,nthChild:Z.Div({class:"flex items-center justify-between mt2 pt1 bt bw1 b--near-white b mid-gray",children:[Z.Div("Overall"),Z.Div({class:"flex items-center",children:[C({className:R`mr2 ${()=>XX.value?.color}`,size:20,iconName:q(()=>`${XX.value?.icon}`)}),q(()=>`${XX.value?.label}`),Z.Span({class:"ml1"}),Z.Div(q(()=>` (${nX.value}%)`))]})]}),map:(X,$)=>Z.Div({class:"flex items-center justify-between mb2",children:[Z.Div(q(()=>`${X.level}`)),Z.Div(q(()=>`${X.total} (${X.percent}%)`))]})})})}),N({title:"Tracker",child:Z.Div({children:[Z.Div({class:"mh2 flex items-center justify-between",children:Z.For({subject:cX,map:(X)=>Z.Div({class:"h2 w2 br-100 gray f7 flex items-center justify-center",children:X.charAt(0)})})}),Z.Div({onmount:(X)=>X.scroll({top:X.scrollHeight-X.clientHeight}),class:"mxh5 mxh6-ns nt2 bb bw1 b--near-white mh2 overflow-y-scroll",children:[Z.Div({class:R`absolute left-0 right-0 bg-to-top-white z-999 ${()=>$X.value.length>4?"h3":""}`}),Z.Div({children:Z.For({subject:$X,n:0,nthChild:Z.Div({class:q(()=>$X.value.length>4?"pv3 mt2":"pv2")}),map:(X)=>Z.Div({class:"flex items-center h-60",children:[Z.Div({class:"w-100 mb3 flex items-center justify-between",children:Z.For({subject:X,map:($)=>{let J=$.date.getDate(),Q=$.date.getMonth(),W=vX[Q].substring(0,3),Y=`${J===1?Q===0?$.date.getFullYear().toString():W:J}`;return GX({classNames:"h2 w2 flex items-center justify-center f7",colorIndex:K.value?.colorIndex??0,level:$.level??-1,totalLevels:K.value?.levels.length||2,textContent:Y,showText:$.level!==void 0,onClick:()=>{if(K.value?.isStopped)return;o.value=!0,d.value={date:$.date,selectedLevelIndex:$.level??0}}})}})})]})})})]})]})})]})}))})]}),bottombar:Z.Div({class:"pb3",children:O({className:"pa3 flex items-center",children:[C({iconName:"arrow_back"}),Z.Span({class:"ml1",children:"Go Back"})],onTap:()=>location.href="/habits/"})})})}),r0=()=>{x.start("mount"),OX.resetIdCounter(),s0(),x.start("run")};r0();
