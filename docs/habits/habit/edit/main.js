var RX=(X)=>{const $=Object.entries(X).sort((W,Q)=>W[0].localeCompare(Q[0]));return $.forEach(([W,Q],J)=>{if(Q&&typeof Q==="object"&&!Array.isArray(Q))$[J]=[W,RX(Q)]}),Object.fromEntries($)},WX=(X)=>{if(typeof X!=="object"||X===null||Array.isArray(X))return!1;return Object.prototype.toString.call(X)==="[object Object]"},XX=(X)=>{if(Array.isArray(X)){const $=[...X],W=[];return $.forEach((Q)=>{W.push(XX(Q))}),W}if(WX(X)){const $={...X},W={};return Object.keys($).forEach((Q)=>{W[Q]=XX($[Q])}),Object.freeze(W)}return X},i=(X)=>{if(Array.isArray(X)){const W=[...X],Q=[];return W.forEach((J)=>{Q.push(i(J))}),Q}if(WX(X)){const W={...X},Q={};return Object.keys(W).forEach((J)=>{Q[J]=i(W[J])}),Q}return X},EX=(X,$="index")=>X.map((W,Q)=>({[$]:Q,value:W})),N0=(X,$)=>{const W=RX(X),Q=RX($),J=Object.keys(W),Z=Object.keys(Q);if(J.length!==Z.length)return!1;for(let Y of J)if(!Z.includes(Y)||!KX(W[Y],Q[Y]))return!1;return!0},O0=(X,$)=>{if(X.length!==$.length)return!1;if(X.length===0)return!0;for(let W=0;W<X.length;W++)if(!KX(X[W],$[W]))return!1;return!0},KX=(X,$)=>{if(typeof X!==typeof $)return!1;if(Array.isArray(X))return O0(X,$);if(X===null||$===null)return X===$;if(typeof X==="object"&&!(X instanceof Set))return N0(X,$);if(typeof X==="bigint"||typeof X==="number"||typeof X==="string"||typeof X==="boolean")return X===$;return X===$},M0=(X,$,W)=>{const J=EX(i(X),"index");return EX(i($),"index").map((Y)=>{let G="add",R=-1;const _=Y.value;return J.some((B,P)=>{if(G=KX(B.value,Y.value)?B.index===Y.index?"idle":"shuffle":W&&B.value[W]!==void 0&&B.value[W]===Y.value[W]?"update":"add",G!=="add")return R=B.index,J.splice(P,1),!0;return!1}),{type:G,oldIndex:R,value:_}})},k0=(X)=>{const $=(W)=>X((Q)=>{const J=Array.from(Q);return W(J),J});return{copyWithin:(...W)=>$((Q)=>Q.copyWithin(...W)),fill:(...W)=>$((Q)=>Q.fill(...W)),pop:(...W)=>$((Q)=>Q.pop(...W)),push:(...W)=>$((Q)=>Q.push(...W)),remove:(...W)=>{const Q=W[0],J=(...Z)=>!Q(...Z);W[0]=J,X((Z)=>{return Z.filter(...W)})},reverse:(...W)=>$((Q)=>Q.reverse(...W)),shift:(...W)=>$((Q)=>Q.shift(...W)),sort:(...W)=>$((Q)=>Q.sort(...W)),splice:(...W)=>$((Q)=>Q.splice(...W)),unshift:(...W)=>$((Q)=>Q.unshift(...W))}},D0=(X)=>{return{set:($)=>X((W)=>({...W,...$}))}},UX=null,TX=(X)=>UX=X,V=(X)=>{let $=XX(X);const W=new Set,Q=()=>{W.forEach((Y)=>{if(Y.canDisposeNow){W.delete(Y);return}Y()})},J=(Y)=>{$=Y,Q()},Z={type:"source-signal",get value(){if(UX)W.add(UX);return i($)},set value(Y){if(Y===$)return;J(XX(Y))}};return Array.isArray(X)?Object.assign(Z,k0((Y)=>J(Y($)))):typeof X==="object"&&X!==null?Object.assign(Z,D0((Y)=>J(Y($)))):Z},n=(X)=>{const $=X;return $.canDisposeNow=!1,$.dispose=()=>{$.canDisposeNow=!0},TX($),X(),TX(null),$},U=(X)=>{let $;const W=V($),Q=n(()=>{$=X($),W.value=$});return{type:"derived-signal",get prevValue(){return $},get value(){return W.value},dispose(){Q.dispose()}}},D=(...X)=>{X.forEach(($)=>$.dispose())},E0=(X)=>{return{type:"non-signal",value:X}},q=(X)=>ZX(X)?X.value:X,v=(X)=>["source-signal","derived-signal"].includes(X?.type),JX=(X,$)=>X?.type==="non-signal"&&(!$||!$.length||$.some((W)=>typeof X?.value===W)),ZX=(X)=>v(X)||JX(X),C=(X,...$)=>{return U(()=>{const W=$.map((Q)=>q(Q));return X(...W)})},M=(X)=>{const $=typeof X==="function"?X:()=>q(X);return{...{get truthy(){return U(()=>!!$())},get falsy(){return U(()=>!$())},get truthyFalsyPair(){return U(()=>{const Q=!!$();return[Q,!Q]})},ternary:(Q,J)=>U(()=>{return $()?q(Q):q(J)})},or:(Q)=>M(()=>{return!!($()||q(Q))}),orNot:(Q)=>M(()=>{return!!($()||!q(Q))}),and:(Q)=>M(()=>{return!!($()&&q(Q))}),andNot:(Q)=>M(()=>{return!!($()&&!q(Q))}),equals:(Q)=>M(()=>{return $()===q(Q)}),notEquals:(Q)=>M(()=>{return $()!==q(Q)}),orBothEqual:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)===q(J);return!!(Z||Y)}),orBothUnequal:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)!==q(J);return!!(Z||Y)}),andBothEqual:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)===q(J);return!!(Z&&Y)}),andBothUnequal:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)!==q(J);return!!(Z&&Y)}),orThisIsLT:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)<q(J);return!!(Z||Y)}),orThisIsLTE:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)<=q(J);return!!(Z||Y)}),orThisIsGT:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)>q(J);return!!(Z||Y)}),orThisIsGTE:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)>=q(J);return!!(Z||Y)}),andThisIsLT:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)<q(J);return!!(Z&&Y)}),andThisIsLTE:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)<=q(J);return!!(Z&&Y)}),andThisIsGT:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)>q(J);return!!(Z&&Y)}),andThisIsGTE:(Q,J)=>M(()=>{const Z=$(),Y=q(Q)>=q(J);return!!(Z&&Y)})}},u=(X)=>{const $=typeof X==="function"?X:()=>q(X);return{...M(X),get result(){return U($)},add:(W)=>u(()=>{return $()+q(W)}),sub:(W)=>u(()=>{return $()-q(W)}),mul:(W)=>u(()=>{return $()*q(W)}),div:(W)=>u(()=>{return $()/q(W)}),mod:(W)=>u(()=>{return $()%q(W)}),pow:(W)=>u(()=>{return $()**q(W)}),isBetween:(W,Q,J=!0,Z=!0)=>M(()=>{const Y=$(),G=q(W),R=q(Q),_=J?Y>=G:Y>G,B=Z?Y<=R:Y<R;return _&&B}),isLT:(W)=>M(()=>$()<q(W)),isLTE:(W)=>M(()=>$()<=q(W)),isGT:(W)=>M(()=>$()>q(W)),isGTE:(W)=>M(()=>$()>=q(W))}},T0=(X)=>{const $=typeof X==="function"?X:()=>q(X);return{...M(X),lengthBetween:(W,Q,J=!0,Z=!0)=>M(()=>{const G=$().length,R=q(W),_=q(Q),B=J?G>=R:G>R,P=Z?G<=_:G<_;return B&&P}),lengthEquals:(W)=>M(()=>{return $().length===q(W)}),lengthNotEquals:(W)=>M(()=>{return $().length!==q(W)}),lengthLT:(W)=>M(()=>{return $().length<q(W)}),lengthLTE:(W)=>M(()=>{return $().length<=q(W)}),lengthGT:(W)=>M(()=>{return $().length>q(W)}),lengthGTE:(W)=>M(()=>{return $().length>=q(W)})}},w=(X)=>{const W=(typeof X==="function"?X:()=>q(X))();return typeof W==="number"?u(X):typeof W==="string"||Array.isArray(W)?T0(X):M(X)},PX=(...X)=>X.map(($)=>q($)),l=(X)=>{return{get string(){return U(()=>{const $=q(X);return $===void 0||$===null?void 0:$.toString()})},or:($)=>U(()=>q(X)||q($))}},H0=(X)=>{const W=["at","copyWithin","fill","includes","indexOf","join","lastIndexOf","slice","with"].reduce((Q,J)=>{const Z=(...Y)=>{return U(()=>{const G=PX(...Y);return q(X)[J](...G)})};return Q[J]=Z,Q},{});return{...l(X),...W,concat:(Q)=>U(()=>q(X).concat(q(Q))),every:(Q)=>U(()=>q(X).every(Q)),filter:(Q)=>U(()=>q(X).filter(Q)),find:(Q)=>U(()=>q(X).find(Q)),findIndex:(Q)=>U(()=>q(X).findIndex(Q)),findLast:(Q)=>U(()=>q(X).findLast(Q)),findLastIndex:(Q)=>U(()=>q(X).findLastIndex(Q)),get lastItem(){return U(()=>{return i(q(X)).pop()})},get length(){return U(()=>q(X).length)},map:(Q)=>U(()=>q(X).map(Q)),partition:(Q)=>{const J=U(()=>q(X).filter(Q)),Z=U(()=>q(X).filter((Y,G,R)=>!Q(Y,G,R)));return[J,Z]},reduce:(Q,J)=>U(()=>q(X).reduce(Q,J)),reduceRight:(Q,J)=>U(()=>q(X).reduceRight(Q,J)),get reversed(){return U(()=>q(X).toReversed())},some:(Q)=>U(()=>q(X).every(Q)),toSorted:(Q)=>U(()=>q(X).toSorted(Q)),toSpliced:(Q,J,...Z)=>U(()=>q(X).toSpliced(q(Q),q(J),...Z))}},w0=(X)=>{const W=["toExponential","toFixed","toPrecision"].reduce((Q,J)=>{const Z=(...Y)=>{return U(()=>{const G=PX(...Y);return q(X)[J](...G)})};return Q[J]=Z,Q},{});return{...l(X),...W,toConfined:(Q,J)=>U(()=>q(X)<q(Q)?q(Q):q(X)>q(J)?q(J):q(X)),toLocaleString:(Q,J)=>U(()=>q(X).toLocaleString(q(Q),J))}},x0=(X)=>{if(!WX(q(X)))throw new Error("Thee argument should be a plain object or a signal of plain object");return{...l(X),prop:($)=>U(()=>q(X)[$]),get props(){return Object.keys(q(X)).reduce((W,Q)=>{const J=Q;return W[J]=this.prop(J),W},{})},get keys(){return U(()=>Object.keys(q(X)))}}},gX=(X)=>{const W=["at","charAt","charCodeAt","codePointAt","concat","endsWith","includes","indexOf","lastIndexOf","padEnd","padStart","repeat","slice","startsWith","substring","trim","trimEnd","trimStart"].reduce((Q,J)=>{const Z=(...Y)=>{return U(()=>{const G=PX(...Y);return q(X)[J](...G)})};return Q[J]=Z,Q},{});return{...l(X),...W,get length(){return U(()=>q(X).length)},get lowercase(){return U(()=>q(X).toLowerCase())},get Sentencecase(){return U(()=>{const Q=q(X);return Q.charAt(0).toUpperCase()+Q.slice(1).toLowerCase()})},get TitleCase(){return U(()=>q(X).toLowerCase().replace(/\b\w/g,(Q)=>Q.toUpperCase()))},get UPPERCASE(){return U(()=>q(X).toUpperCase())},localeCompare:(Q,J,Z)=>U(()=>q(X).localeCompare(q(Q),q(J),Z)),normalize:(Q)=>U(()=>q(X).normalize(q(Q))),replace:(Q,J)=>U(()=>q(X).replace(q(Q),q(J))),replaceAll:(Q,J)=>U(()=>q(X).replaceAll(q(Q),q(J))),search:(Q)=>U(()=>q(X).search(Q)),split:(Q,J)=>U(()=>{const Z=Q instanceof RegExp?Q:q(Q);return q(X).split(Z,q(J))}),toLocaleLowerCase:(Q)=>U(()=>q(X).toLocaleLowerCase(q(Q))),toLocaleUpperCase:(Q)=>U(()=>q(X).toLocaleUpperCase(q(Q)))}},f0=V("dksjfbksjnd"),j4=gX(f0).split(""),T=(X)=>{return typeof q(X)==="number"?w0(X):typeof q(X)==="string"?gX(X):Array.isArray(q(X))?H0(X):WX(q(X))?x0(X):l(X)},F=(X,...$)=>U(()=>{return X.reduce((W,Q,J)=>{let Z;const Y=$[J];if(typeof Y==="function")Z=Y()??"";else if(ZX(Y))Z=Y.value??"";else Z=Y??"";return`${W}${Q}${Z.toString()}`},"")});var _X=86400000,S0=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],L0=["January","February","March","April","May","June","July","August","September","October","November","December"],CX=(X,$)=>S0[X].substring(0,$),I0=(X,$)=>L0[X].substring(0,$),jX=(X)=>{return new Date(X.getFullYear(),X.getMonth(),X.getDate())},m=(X)=>jX(X).getTime(),AX=(X,$)=>m(X)===m($),V0=(X,$)=>{const W=$||new Date;return m(X)>m(W)},y0=(X,$)=>{const W=m(X),Q=m($);return Math.round((Q-W)/_X)},g0=(X)=>y0(new Date,X),bX=(X,$)=>new Date(X.getFullYear(),X.getMonth(),X.getDate()+$),C0=(X)=>{const $=new Date;return Array(X).fill(0).map((W,Q)=>new Date($.getFullYear(),$.getMonth()-Q,1)).reverse()},b0=(X,$)=>{const W=m(X),Q=m($);if(W===Q)return[jX(new Date(W))];const J=W<Q?W:Q,Y=((W<Q?Q:W)-J)/_X;return Array(Y+1).fill(0).map((G,R)=>new Date(J+R*_X))},h0=(X)=>{if(X<1)throw"";const $=new Date,W=$.getFullYear(),Q=$.getMonth(),J=new Date(W,Q-(X-1),1),Z=new Date(W,Q+1,0);return{startDate:J,endDate:Z}},hX=["#e87b52","#F5E06F","#A3BA64","#7095C9","#A59EE3","#D89DBF"],v0=[1,1,1,1,1,1,1],c0=[{name:"Not Applicable",code:-1,isMaxLevel:!1},{name:"Paused",code:-2,isMaxLevel:!1},{name:"Stopped",code:-3,isMaxLevel:!1}],BX=["Not started","Completed"],m0=[70,60,45],HX={id:"analytics",lastInteraction:(new Date()).getTime()},$X={id:"local-settings",habitsPage:{tabIndex:0,sortOptionIndex:0},editPage:{showHints:!0,showFullCustomisation:!1}},wX=[{icon:"calendar_month",decending:!0,label:"Date created (Newest first)"},{icon:"calendar_month",decending:!1,label:"Date created (Oldest first)"},{icon:"task_alt",decending:!0,label:"Completion (Highest first)"},{icon:"task_alt",decending:!1,label:"Completion (Lowest first)"}],vX=["onmount","onunmount"],cX=["onerror","onload","onresize","onblur","onchange","oncontextmenu","onfocus","oninput","oninvalid","onreset","onselect","onsubmit","onkeydown","onkeypress","onkeyup","onclick","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onscroll","onabort","oncanplay","oncanplaythrough","ondurationchange","onemptied","onended","onerror","onloadeddata","onloadedmetadata","onloadstart","onpause","onplay","onplaying","onprogress","onratechange","onseeked","onseeking","onstalled","onsuspend","ontimeupdate","onvolumechange","onwaiting"],p0=[...cX,...vX],u0=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],e,mX=(X)=>{if(!e)e=document.createElement("textarea");return e.innerHTML=X,e.value},d0=(X)=>{try{return decodeURIComponent(X)}catch{return X}},r0=(X)=>{return X.replace(/\\u[\dA-Fa-f]{4}/g,($)=>String.fromCharCode(parseInt($.slice(2),16))).replace(/\\x[\dA-Fa-f]{2}/g,($)=>String.fromCharCode(parseInt($.slice(2),16)))},o0=()=>{let X=0;return{getNewId:()=>++X,resetIdCounter:()=>X=0}},pX=o0(),y={currentIs:(X)=>window._currentAppPhase===X,start:(X)=>{window._currentAppPhase=X,console.log(`Current phase is ${X}`)}},uX=(X,$,W)=>{let Q=X;Q=mX(Q),Q=d0(Q),Q=r0(Q);const J=Q.trim().toLowerCase();for(let Z of $)if(Z.test(J))throw W;return X},i0=(X)=>uX(X,[/^javascript\s*:/i,/^data\s*:/i,/^vbscript\s*:/i,/^file\s*:/i],'The href attribute value starting with one of "javascript:", "data:", "vbscript:" or "file:" is not allowed.'),s0=(X)=>uX(X,[/url\s*\(/i,/expression\s*\(/i,/javascript\s*:/i,/data\s*:/i,/vbscript\s*:/i,/file\s*:/i],'The style attribute value starting with one of "url(..", "expression(..", "javascript:", "data:", "vbscript:" or "file:" is not allowed.'),n0=(X,$)=>{if(X==="href"){if(typeof $==="boolean")throw"The value of 'href' attribute should not be a boolean";return i0($||"")}if(X==="style"){if(typeof $==="boolean")throw"The value of 'style' attribute should not be a boolean";return s0($||"")}return $},NX=(X)=>Array.isArray(X),QX=(X)=>!isNaN(X?.elementId)&&X?.elementId>0,h=(X)=>X===void 0||typeof X==="string"||typeof X==="function"&&X.isElementGetter,dX=(X)=>NX(X)&&X.every(($)=>h($)),rX=(X)=>h(X)||dX(X),oX=(X)=>JX(X)&&h(X.value),FX=(X)=>v(X)&&h(X.value),l0=(X)=>JX(X)&&rX(X.value),iX=(X)=>v(X)&&rX(X.value),sX=(X)=>NX(X)&&X.every(($)=>h($)||oX($)||FX($)),a0=(X)=>!v(X)&&(h(X)||l0(X)||sX(X)),nX=(X)=>a0(X)||iX(X),t0=()=>{if(window.navigator?.vibrate)window.navigator.vibrate(3)},OX=(X,$,W)=>{const Q=JSON.parse(X||"{}"),J=Q&&typeof Q==="object",Z=Q[$];if(!J||!(W?Z===W:!!Z))return;return Q},S=(X)=>{return(...$)=>{return t0(),K1(new Date),X&&X(...$)}},lX={href:"/",HABITS:{href:"/habits/",NEW:{href:"/habits/new/"},HABIT:{href:"/habits/habit/",EDIT:{href:"/habits/habit/edit/"}}},SETTINGS:{href:"/settings/",PRIVACY_POLICY:{href:"/settings/privacy-policy/"}}},e0=(X)=>location.href=X,X1=()=>location.href=lX.HABITS.NEW.href,$1=(X)=>location.href=`${lX.HABITS.HABIT.href}?id=${X}`,Q1=(X)=>{if(!y.currentIs("run"))return"";const $=window.location.search;return new URLSearchParams($).get(X)||""},aX="analytics",W1="id",J1="analytics",tX=(X)=>{localStorage.setItem(aX,JSON.stringify(X))},Z1=()=>{if(!y.currentIs("run"))return HX;const X=()=>{const Q=localStorage.getItem(aX);return OX(Q,W1,J1)};if(!X())tX(HX);const W=X();if(!W)throw"Error fetching analytics";return W},Y1=()=>{const X=[];for(let $ in localStorage){if(!localStorage.hasOwnProperty($))continue;X.push($)}return X},z1=(X)=>X.startsWith("h."),MX=(X)=>`h.${X}`,eX=(X)=>{if(!z1(X))return;const $=localStorage.getItem(X),W=OX($,"title");if(!W)return;return W},q1=()=>{if(!y.currentIs("run"))return[];const X=[];for(let $ of Y1()){const W=eX($);if(!W)continue;X.push(W)}return X},G1=(X)=>{const $=MX(X.id);localStorage.setItem($,JSON.stringify(X))},R1=(X)=>{const $=MX(X);localStorage.removeItem($)},X0="settings",U1="id",_1="local-settings",$0=(X)=>{localStorage.setItem(X0,JSON.stringify(X))},B1=()=>{if(!y.currentIs("run"))return $X;const X=()=>{const Q=localStorage.getItem(X0);return OX(Q,U1,_1)};if(!X())$0($X);const W=X();if(!W)throw"Error fetching settings";return F1(W),X()},F1=(X)=>{if(!X.editPage)$0({...X,editPage:$X.editPage})},K1=(X)=>{const $=Z1();tX({...$,lastInteraction:X.getTime()})},P1=()=>{return B1().editPage},Q0=(X)=>{const $=MX(X),W=eX($);if(!W)throw`Error fetching habit with id '${X}' from storage`;return kX(W)},j1=(X)=>{const W=q1().find((Q)=>Q.title.trim()===X.trim());return W?kX(W):void 0},W0=(X)=>{const $=T1(X);G1($)},A1=(X)=>{const $={...X,isStopped:!0};W0($)},N1=(X)=>R1(X),O1=1.6181,M1=()=>{const $=+Q1("id");if(isNaN($)||!$)return;try{return Q0($)}catch(W){return}},k1=(X)=>c0.find(($)=>$.code===X),J0=(X,$)=>{return X<0?k1(-1):{isMaxLevel:X===$.length-1,name:$[X],code:X}},D1=(X)=>({key:X.getTime(),level:J0(-1,[]),date:X}),E1=(X,$,W)=>({key:W.getTime(),level:J0(X,$),date:W}),Z0=(X,$)=>X.find((W)=>AX(W.date,$)),kX=(X)=>{const $=jX(new Date(X.id));return{...X,startDate:$,levels:X.levels.map((W,Q)=>({isMaxLevel:Q===X.levels.length-1,name:W,code:Q})),tracker:X.tracker.map((W,Q)=>E1(W,X.levels,bX($,Q))),milestones:w1(X.milestones)}},T1=(X)=>{return{...X,levels:X.levels.map(($)=>$.name),tracker:X.tracker.map(($,W)=>$.level.code),milestones:x1(X.milestones)}},H1=()=>{const $={id:(new Date()).getTime(),title:"",frequency:v0,colorIndex:0,levels:BX,tracker:[],milestones:m0,pauses:[],isStopped:!1};return kX($)},w1=(X)=>[{label:"Successful",upperLimit:100,percent:X[0],icon:"verified_user",color:"green"},{label:"Little more to go",upperLimit:X[0],percent:X[1],icon:"done_all",color:"light-blue"},{label:"Going good",upperLimit:X[1],percent:X[2],icon:"check",color:"blue"},{label:"Unacceptable",upperLimit:X[2],percent:0,icon:"close",color:"red"}],x1=(X)=>X.filter(($)=>!!$.percent).map(($)=>$.percent),Y0=(X,$)=>{let W=X[0];for(let Q=0;Q<X.length;Q++)if(W=X[Q],W.percent<=$)break;return{label:W.label,icon:W.icon,color:W.color}},f1=(X,$)=>{if(!X.title)return"Title should not be empty";if($&&j1(X.title))return"A habit with same name already exists";if(X.frequency.every((Q)=>!Q))return"Select at least one day in a week";if(!X.levels.every((Q)=>!!Q.name))return"One of the levels is empty";if(X.levels.some((Q,J)=>{for(let Z=J+1;Z<X.levels.length;Z++)if(X.levels[Z].name===Q.name)return!0;return!1}))return"Multiple levels have same name";if(!X.milestones.every((Q)=>Q.percent<=100&&Q.percent>=0))return"The milestones should be between 0 and 100 percents";if(!X.milestones.every((Q,J,Z)=>J===0?!0:Z[J-1].percent>Q.percent))return"Milestones should be in order (from high to low)";return""},z0=(X,$,W)=>{const Q=q0(X.tracker,$,W),J=X.levels.length-1;let Z=0,Y=0,G=0,R=0,_=0,B=0;return Q.forEach((P,K)=>{if(Z+=P.level.code>-1?1:0,Y+=P.level.code>0?1:0,G+=P.level.code>0?P.level.code:0,K===Q.length-1)return;const N=P.level.code<1;B=N?B+1:0;const E=100*((P.level.code>0?P.level.code:0)/(X.levels.length-1));R=Math.round(E)>50?R+1:0,_=N?0:_+1}),{title:X.title,aceStreak:R,followStreak:_,missed:B,percent:Math.round(100*(G/(Z*J))),totalDays:Z,workingDays:Y}},S1=(X,$,W)=>{const Q=!!X.length;if(!Q)return{hideAddButton:!1,hideRemoveButton:$.length<3};const J=$[W],Z=!!(Q&&X.find((K)=>K.name===J.name)),Y=X.length!==$.length,G=$.length<X.length,R=$.length>X.length,_=!Y&&X.length&&X.some((K,j)=>K.name!==$[j].name);return{hideAddButton:G||_||Z&&G,hideRemoveButton:G||_||Z&&R}},L1=(X,$,W)=>{const Q=!!X.length,J=$[W],Z=!!(Q&&X.find((G)=>G.name===J.name)),Y=X.length!==$.length;return Z&&Y},I1=(X,$,W,Q=!1)=>{const J=hX[W],Z=X/($-1),G=Math.trunc(Math.pow(Z,O1)*255).toString(16),R=G.length===1?`0${G}`:G,_=X<0||R==="0"?"transparent":`${J}${R}`,B=Q?X/($-1)>0.5?"white":"black":X<0?"lightgray":"transparent";return{backgroundColor:_,fontColor:B,peakBackgroundColor:J,levelPercent:Math.round(Z*100)}},V1=(X,$)=>{const W=[];for(let Q of $)if(!X.some((Z)=>{if(AX(Z.date,Q))return W.push(Z),!0;return!1}))W.push(D1(Q));return W},q0=(X,$,W)=>{const Q=b0($,W);return V1(X,Q)},y1=(X)=>{const $=new Date,W=new Date(X),Q=-g0(W);if(Q===0)return"Just created this habit today";if(Q===1)return"This habit started from yesterday";if(Q>1&&Q<5)return`Started following this ${Q} back`;const{aceStreak:J,followStreak:Z,missed:Y}=z0(Q0(X),bX($,-Q),$);if(J>=12)return`Nailed ${J} days in a row. Woah! Don't stop.`;if(J>=4)return`Doing good for ${J} days straight! Keep it up.`;if(Z>=15)return`Didn't miss for ${Z} days in a row. Kudos!`;if(Z>=4)return`${Z} days in a row. Nice! keep going.`;if(Y)`Missed ${Y} days. Impossible is I M Possible.`;return"Just stick to it. Patience is the key."},g1=(X,$,W)=>{if(!X.length||X.length===$.length)return W;const Q=[...W],J=[];return X.forEach((Z,Y)=>{const G=$.find((P)=>P.name===Z.name),R=!G,_=(P)=>{const K=[];W.forEach((j,N)=>{if(j.level.code===Z.code)K.push(N)}),J.push({indices:K,newLevel:P})};if(R){if(Y===X.length-1)_($[$.length-1]);return}if(G.code===Z.code)return;_(G)}),J.forEach((Z)=>{Z.indices.forEach((Y)=>{Q[Y]={...Q[Y],level:Z.newLevel}})}),Q},xX=(X)=>{const $=X.length-1;for(let W=0;W<X.length;W++)X[W]={...X[W],code:W,isMaxLevel:W===$};return X},C1=(X)=>[{label:"Today",icon:"calendar_month",isSelected:X==="/",href:"/"},{label:"Habits",icon:"checklist",isSelected:X==="/habits/",href:"/habits/"},{label:"Settings",icon:"settings",isSelected:X==="/settings/",href:"/settings/"}],fX=!1,b1={},o={},h1=globalThis.MutationObserver,v1=new h1((X)=>{X.forEach(($)=>{if($.type==="childList")$.addedNodes.forEach((W)=>{if(QX(W)){const Q=W,J=Q.elementId;if(o[J])delete o[J];else b1[J]=Q.tagName}}),$.removedNodes.forEach((W)=>{if(QX(W)){const Q=W,J=Q.elementId,Z=Q.unmountListener;if(Z)o[J]={element:Q,unmountListener:Z}}})}),Object.entries(o).forEach(([$,W])=>{const{element:Q,unmountListener:J}=W;G0(Q,J)})}),G0=(X,$)=>{if(!QX(X))return;const W=X.children;for(let Q=0;Q<W.length;Q++){const J=W[Q];G0(J,J.unmountListener)}if($&&$(X),o[X.elementId])delete o[X.elementId]},c1=()=>{if(!fX&&!y.currentIs("build"))v1.observe(document.body,{childList:!0,subtree:!0}),fX=!0},R0=(X,$)=>p0.includes(X)&&$===void 0,U0=(X,$)=>cX.includes(X)&&typeof $==="function",_0=(X,$)=>vX.includes(X)&&typeof $==="function",m1=(X,$)=>R0(X,$)||U0(X,$)||_0(X,$),p1=(X,$)=>{Object.entries($).forEach(([W,Q])=>{if(R0(W,Q));else if(U0(W,Q)){const J=W.slice(2);X.addEventListener(J,(Z)=>{if(J==="keypress")Z.preventDefault();Q(Z)})}else if(_0(W,Q)){if(W==="onmount"&&!y.currentIs("build")){const J=Q;setTimeout(()=>J(X),0)}if(W==="onunmount"){c1();const J=X.unmountListener;X.unmountListener=(Z)=>{if(Q(Z),typeof J==="function")J(Z)}}}else console.error(`Invalid event key: ${W} for element with tagName: ${X.tagName}`)})},SX=(X,$,W)=>{const Q=ZX(W)?W.value:W,J=n0($,Q);if(typeof J==="boolean")if(J)X.setAttribute($,"");else X.removeAttribute($);else if($==="value")X.value=J||"";else X.setAttribute($,J||"")},u1=(X,$)=>{const W={};Object.entries($).forEach((J)=>{const[Z,Y]=J;if(v(Y))W[Z]=Y;SX(X,Z,Y)});const Q=n(()=>{Object.entries(W).forEach((J)=>{const[Z,Y]=J,G=Y.value;if(!y.currentIs("run"))return;SX(X,Z,G)})});X.effects.push(Q)},d1=(X)=>{if(!X||typeof X==="string")return document.createTextNode(mX(X||""));if(h(X)){const $=X();if(!QX($))throw new Error(`Invalid MHtml element getter child. Type: ${typeof X}`);return $}throw new Error(`Invalid child. Type of child: ${typeof X}`)},qX=(X,$,W)=>{const Q=X.childNodes[W],J=d1($);if(Q&&J)X.replaceChild(J,Q);else if(J)X.appendChild(J);else console.error(`No child found for node with tagName: ${X.tagName}`)},r1=(X,$)=>{if(!$)return;if(iX($)){const J=n(()=>{const Z=$.value,Y=NX(Z)?Z:[Z];Y.forEach((R,_)=>qX(X,R,_));const G=Y.length;while(G<X.childNodes.length){const R=X.childNodes[G];if(R)X.removeChild(R)}});X.effects.push(J)}const W=h($)?[$]:JX($)?h($.value)?[$.value]:dX($.value)?$.value:[]:sX($)?$.map((J)=>FX(J)?J:oX(J)?J.value:J):[],Q=[];if(W.forEach((J,Z)=>{if(FX(J))Q.push({index:Z,signalChild:J});const Y=q(J);qX(X,Y,Z)}),Q.length)Q.forEach(({index:J,signalChild:Z})=>{const Y=n(()=>{const G=Z.value;if(!y.currentIs("run"))return;qX(X,G,J)});X.effects.push(Y)})},o1=(X,$)=>{let W=void 0;const Q={},J={};return Object.entries(X).forEach(([Z,Y])=>{if(Z==="children")if(nX(Y))W=Y;else throw new Error(`Invalid children prop for node with tagName: ${$}\n\n ${JSON.stringify(Y)}`);else if(m1(Z,Y))Q[Z]=Y;else J[Z]=Y}),{children:W,eventProps:Q,attributeProps:J}},i1=(X,$)=>{const W=()=>{const Q=pX.getNewId(),J=y.currentIs("mount")?document.querySelector(`[data-elem-id="${Q}"]`):document.createElement(X);J.elementId=Q,J.effects=[],J.unmountListener=()=>{J.effects.forEach((G)=>G.dispose())};const Z=nX($)?{children:$}:$;if(!y.currentIs("run"))Z["data-elem-id"]=J.elementId.toString();const Y=o1(Z,J.tagName);if(p1(J,Y.eventProps),u1(J,Y.attributeProps),r1(J,Y.children),!y.currentIs("build"))J.removeAttribute("data-elem-id");return J};return W.isElementGetter=!0,W},LX=(X,$,W)=>{const Q=V($),J=V(X),Z=W(U(()=>J.value),U(()=>Q.value));let Y,G,R=!1;if(Z?.isElementGetter)Y=()=>{if(R&&G)return G;return G=Z(),R=!0,G},Y.isElementGetter=!0;else if(!Z||typeof Z==="string")Y=Z||"";else throw`One of the child, ${Z} passed in ForElement is invalid.`;return{indexSignal:Q,itemSignal:J,mappedChild:Y}},GX=(X,$,W)=>{if($!==void 0&&$>=0&&W){const Q=$>X.length?X.length:$;X.splice(Q,0,W)}return X},s1=({subject:X,itemKey:$,map:W,n:Q,nthChild:J})=>{if(J&&Q===void 0||Q!==void 0&&Q>-1&&!J)throw new Error("Either both 'n' and 'nthChild' be passed or none of them.");let Z=J;if(J&&typeof J!=="string"){const K=J(),j=()=>K;j.isElementGetter=!0,Z=j}if(!v(X))return GX(q(X).map(W),Q,Z);const Y=U(()=>{const K=q(X);return Array.isArray(K)?K:[]});if(!$)return U(()=>GX(Y.value.map(W),Q,Z));const G=Y.value;if(G.length&&typeof G[0]!=="object")throw new Error("for mutable map, item in the list must be an object");let R=null;const _=U((K)=>{return R=K||R,Y.value}),B=U((K)=>{if(!K||!R)return _.value.map((H,E)=>LX(H,E,W));return M0(R,_.value,$).map((N,H)=>{const E=(K||[])[N.oldIndex];if(console.assert(N.type==="add"&&N.oldIndex===-1&&!E||N.oldIndex>-1&&!!E,"In case of mutation type 'add' oldIndex should be '-1', or else oldIndex should always be a non-negative integer."),E){if(N.type==="shuffle")E.indexSignal.value=H;if(N.type==="update")E.indexSignal.value=H,E.itemSignal.value={...N.value};return E}return LX(N.value,H,W)})});return U(()=>GX(B.value.map((K)=>K.mappedChild),Q,Z))},n1=({subject:X,isTruthy:$,isFalsy:W})=>{const Q=z.Span({style:"display: none;"}),J=()=>q(X)?$?$(X):Q:W?W(X):Q;return v(X)?U(J):J()},l1=({subject:X,caseMatcher:$,defaultCase:W,cases:Q})=>{const J=()=>{const Z=q(X),Y=q(Q);let G=void 0;for(let[R,_]of Object.entries(Y)){const B=$&&$(Z,R),P=`${Z}`===R;if(B||P){G=_();break}}return G||W&&W()||z.Span({style:"display: none;"})};return v(X)?U(J):J()},a1=u0.reduce((X,$)=>{const W=$.split("").map((J,Z)=>!Z?J.toUpperCase():J).join(""),Q=(J)=>i1($,J);return X[W]=Q,X},{}),t1={For:s1,If:n1,Switch:l1},z={...a1,...t1},e1=(X)=>{const $=q(X);return Array.isArray($)&&$.some((W)=>ZX(W))},O=(X)=>($)=>{for(let Q of Object.keys($))if($[Q]===void 0)delete $[Q];const W=Object.entries($).reduce((Q,J)=>{const[Z,Y]=J,G=v(Y)||typeof Y==="function"?Y:e1(Y)?q(Y):E0(q(Y));return Q[Z]=G,Q},{});return X(W)},X4=O(({cssClasses:X,hideRemove:$,hideAdd:W,onRemove:Q,onAdd:J})=>{const Z=w($).and(W).ternary("bn","ba"),Y=F`br3 pb1 f4 bw1 b--light-silver dark-gray ${Z} ${X}`,G=w(W).ternary("","br"),R=F`pointer ph2 pb1 bw1 b--light-silver ${G}`,_=()=>D(Z,Y,G,R);return z.Span({onunmount:_,class:Y,children:[z.If({subject:$,isFalsy:()=>z.Span({class:R,onclick:S(Q),children:"-"})}),z.If({subject:W,isFalsy:()=>z.Span({class:"pointer ph2 pb1",onclick:S(J),children:"+"})})]})}),p=O(({cssClasses:X,onTap:$,onUnmount:W,children:Q})=>{const J=F`pointer noselect br-pill ba bw1 b--light-silver b--hover-black bg-white black ${X}`,Z=()=>{if(D(J),W)W()};return z.Button({onunmount:Z,class:J,onclick:S(()=>$()),children:Q})}),A4=O(({cssClasses:X})=>{const $=F`bb b--light-gray ${X}`;return z.Div({onunmount:()=>D($),class:$})}),b=O(({cssClasses:X,size:$,onClick:W,iconName:Q,title:J})=>{const Y=F`material-symbols-outlined ${W?"pointer":""} ${X}`,G=T($).or(16),R=F`font-size: ${G}px`;return z.Span({onunmount:()=>D(Y,G,R),class:Y,style:R,onclick:S(W),children:Q,title:J})}),IX=O(({cssClasses:X,href:$,target:W,onClick:Q,children:J})=>{const Z=w($).or(Q).ternary("pointer underline",""),Y=F`w-fit-content noselect ${Z} ${X}`;return z.A({onunmount:()=>D(Z,Y),...$?{href:$}:{},class:Y,target:W,onclick:S(Q),children:J})}),YX=O(({cssClasses:X,isOpen:$,content:W,onTapOutside:Q,onUnmount:J})=>{const Z=F`pa0 br3 ${X}`,Y=(R)=>{setTimeout(()=>n(()=>{if($.value)R.showModal();else R.close()}))},G=()=>{if(D(Z),J)J()};return z.Dialog({onmount:Y,onunmount:G,onclick:S(Q),class:Z,children:[z.Div({onclick:(R)=>R.stopPropagation(),children:W})]})}),$4=O(({cssClasses:X,placeholder:$,num:W,onchange:Q})=>{const J=T(W).string,Z=(Y)=>{const G=Y.target.value,R=Number.parseFloat(Number.parseFloat(G||"0").toFixed(2));Q(R)};return z.Input({onunmount:()=>D(J),class:X,type:"number",placeholder:$,value:J,onchange:Z})}),Q4=O(({progress:X,cssClasses:$})=>{const W=F`br-pill bg-moon-gray ${$}`,Q=F`width: ${T(X).toConfined(0,100)}%;`;return z.Div({onunmount:()=>D(W,Q),class:W,children:z.Div({class:"br-pill bg-app-theme-color pa1",style:Q})})}),B0=O(({cssClasses:X,header:$,content:W,bottombar:Q})=>{const J=F`w6-ns ${X}`;return z.Div({onunmount:()=>D(J),class:"flex-ns justify-center-ns",children:z.Div({class:J,children:[z.If({subject:$,isTruthy:()=>z.Div({class:"overflow-break-word sticky top-0 left-0 right-0 bg-inherit z-999 f2dot33 b pv3 mt2",children:$})}),W,z.Div({class:"pv6 mt5"}),z.If({subject:Q,isTruthy:()=>z.Div({class:"sticky bottom-0 left-0 right-0 z-9999",children:Q})})]})})}),N4=O(({cssClasses:X,tabs:$,onTabChange:W})=>{const Q=F`bg-white br3 ${X}`,J=T($).map((Z)=>{return{tabClasses:`
                w-100 br3 pv2dot5 ph2 flex justify-center noselect br-pill ba bw1 bg-inherit
                ${Z.isSelected?`b--light-silver b black ${Z.classes||""}`:"pointer b--transparent b--hover-black silver pointer"} ${Z.classes}`,label:Z.label}});return z.Div({onunmount:()=>D(Q,J),class:Q,children:z.Div({class:"flex items-center justify-between pa1",children:z.For({subject:J,itemKey:"label",map:(Z,Y)=>{const{tabClasses:G,label:R}=T(Z).props;return z.Span({onunmount:()=>D(G,R),onclick:S(()=>W(Y.value)),class:G,children:R})}})})})}),VX=O(({cssClasses:X,placeholder:$,disabled:W,text:Q,onmount:J,onchange:Z,onkeydown:Y,onfocus:G,onblur:R})=>{let _;const B=w(W).truthy,P=(N)=>{if(_=N,J)J(N)},K=(N)=>{const H=N.target.value;if(Z)Z(H)},j=(N)=>{const H=N.key.length===1?_.value+N.key:N.key==="Backspace"?_.value.slice(0,-1):_.value,E={key:N.key,text:H};if(Y)Y(E)};return z.Input({onmount:P,onunmount:()=>D(B),class:X,type:"text",placeholder:$,disabled:B,value:Q,onchange:K,onkeydown:j,onfocus:G,onblur:R})}),O4=O(({cssClasses:X,isOn:$,onToggle:W})=>{const Q=F`flex items-center pointer noselect br-pill ba bw1dot5 b--mid-gray b--hover-black bg-white pa05 black ${X}`,Z=F`${"br-100 ba bw1 b--hover-black pa1"} ${()=>$.value?"b--transparent":"b--moon-gray bg-moon-gray"}`,Y=F`${"br-100 ba bw1 b--hover-black pa1"} ${()=>$.value?"b--mid-gray bg-mid-gray":"b--transparent"}`;return z.Div({onunmount:()=>D(Q,Z,Y),class:Q,onclick:S(W),children:[z.Div({class:Z}),z.Div({class:"pa05"}),z.Div({class:Y})]})}),W4=O(({cssClasses:X,justifyCssClasses:$,label:W})=>{const Q=T($).or("justify-end"),J=T(W).or("Add habit"),Z=F`w-100 flex ${Q} ${X}`;return z.Div({onunmount:()=>D(Q,J,Z),class:Z,children:p({cssClasses:"pa3 mb3 shadow-4 b flex items-center",children:[b({cssClasses:"nl1 mr1",size:22,iconName:"add"}),J],onTap:X1})})}),zX=O(({cssClasses:X,dotCssClasses:$,colorIndex:W,level:Q,totalLevels:J,showText:Z,textContent:Y,icon:G,iconSize:R,isRectangular:_,showHeight:B,onClick:P})=>{const K=w(_).ternary("br0","br-100"),j=w(Q).isLT(0).ternary("bg-transparent","bg-light-gray"),N=C(I1,Q,J,W,Z),{peakBackgroundColor:H,backgroundColor:E,fontColor:x,levelPercent:L}=T(N).props,I=T(Y).or("\u0387"),g=w(B).and(G).andThisIsGT(L,99).truthy,c=F`pointer relative overflow-hidden ${K} ${j} ${X}`,d=F`flex items-center justify-around absolute left-0 right-0 bottom-0 br0 ${$}`,s=F`
      background-color: ${H};
      color: white;
      height: ${L}%;`,a=F`flex items-center justify-around absolute absolute--fill ${$}`,t=F`
      background-color: ${E};
      color: ${x};`,k=()=>{if(P&&Q.value>=0)P()},A=()=>{D(K,j,N,H,E,x,L,I,g,c,d,s,a,t)};return z.Span({onunmount:A,class:c,onclick:S(k),children:z.If({subject:B,isTruthy:()=>z.Span({class:d,style:s,children:z.If({subject:g,isTruthy:()=>b({iconName:G,size:R})})}),isFalsy:()=>z.Span({class:a,style:t,children:z.If({subject:G,isTruthy:(f)=>b({iconName:f,size:R}),isFalsy:()=>z.Span(I)})})})})}),M4=O(({habit:X,day:$,onColorDotClick:W})=>{const{id:Q,title:J,colorIndex:Z,levels:Y,tracker:G}=T(X).props,R=T(Y).length,_=U(()=>{return Z0(G.value,$.value).level.code}),B=w(_).isGT(0).truthy,P=w(_).isLT(1).ternary("b--light-silver","b--transparent"),K=F`pa3 mr3 ba b ${P}`,j=()=>D(Q,J,Z,Y,G,R,_,B,P);return z.Div({onunmount:j,class:"mt4 flex items-center",children:[zX({cssClasses:K,colorIndex:Z,level:_,totalLevels:R,icon:"check",iconSize:22,showText:B,showHeight:!0,onClick:W}),z.Div({class:"pointer",onclick:S(()=>$1(Q.value)),children:[z.Div({class:"f5 fw6 f4-ns fw4-ns",children:J}),z.Div({class:"f6 light-silver pt05",children:y1(Q.value)})]})]})}),J4=O(({cssClasses:X})=>{const $=F`pa3 flex items-center ${X}`;return p({onUnmount:()=>D($),cssClasses:$,children:[b({iconName:"arrow_back"}),z.Span({class:"ml1",children:"Go Back"})],onTap:()=>history.back()})}),k4=O(({cssClasses:X,milestones:$,achievedMilestone:W,completionPercent:Q})=>{const J=T(W).prop("color"),Z=C((K)=>K>53?"Average completion":K>43?"Avg completion":K>35?"Completion":"",Q),Y=F`center ${X}`,G=F`nt3dot6 h1dot2 bw1 relative br b--${J}`,R=F`width: ${Q}%;`,_=F`absolute right-0 pr1 b f6 ${J}`,B=F`${Q}%`,P=()=>D(J,Z,Y,G,R,_,B);return z.Div({onunmount:P,class:Y,children:[z.Div({class:"pb2 w-100 relative",children:z.For({subject:$,map:(K,j)=>{return Z4({colorCss:`bg-${K.color}`,percent:K.upperLimit,hideUpperLimit:j===0})}})}),z.Div({class:G,style:R,children:z.Div({class:"relative flex items-start nt1 justify-between f7 mid-gray",children:[z.Div(Z),z.Div({class:_,children:B})]})})]})}),Z4=O(({colorCss:X,hideUpperLimit:$,percent:W})=>{const Q=w($).ternary("",F`${W}%`),J=F`width: ${W}%;`,Z=F`absolute absolute-fill h0dot15 w-100 ${X}`;return z.Div({onunmount:()=>D(Q,J,Z),class:"absolute flex items-start h0dot5 bl br b--light-silver bw1",style:J,children:[z.Div({class:Z}),z.Div({class:"flex justify-end w-100 pt2 f7",children:z.Div({class:"nr3 pb2 light-silver b",children:Q})})]})}),Y4=O(({cssClasses:X,habit:$,date:W,colorIndex:Q,totalLevels:J})=>{const Z=U(()=>{const _=W.value.getFullYear(),B=W.value.getMonth(),P=new Date(_,B,1),K=new Date(_,B+1,0);return q0($.value.tracker,P,K).map((j)=>({...j,level:j.level.code}))}),Y=F`flex items-center ${X}`,G=U(()=>I0(W.value.getMonth(),3)),R=()=>D(Z,Y,G);return z.Div({onunmount:R,class:Y,children:[z.Div({class:"f8 b w2 light-silver",children:G}),z.Div({class:"w-100 flex items-center justify-between",children:z.For({subject:Z,itemKey:"key",map:(_)=>{const B=T(_).prop("level");return zX({cssClasses:"pa1",colorIndex:Q,level:B,totalLevels:J})}})})]})}),D4=O(({cssClasses:X,habit:$,months:W,onClick:Q})=>{const{milestones:J,title:Z,colorIndex:Y,levels:G}=T($).props,R=C((x,L)=>{const{startDate:I,endDate:g}=h0(x);return z0(L,I,g).percent},W,$),_=C(Y0,J,R),{icon:B,color:P}=T(_).props,K=C((x)=>C0(x).map((L)=>({monthFirstDate:L,index:L.getTime()})),W),j=F`pointer bg-white ${X}`,N=F`mr1 ${P}`,H=F`${R}%`,E=()=>{D(J,Z,Y,G,R,_,B,P,K,j,N,H)};return z.Div({onunmount:E,class:j,onclick:S(Q),children:[z.Div({class:"flex items-center justify-between nt1 mb2",children:[z.Div({class:"f5 dark-gray b",children:Z}),z.Div({class:"f6 silver b flex items-center",children:[b({cssClasses:N,iconName:B}),H]})]}),z.Div({class:"mt2 mb1",children:z.For({subject:K,itemKey:"index",map:(x)=>{return Y4({cssClasses:"mb1",habit:$,date:T(x).prop("monthFirstDate"),colorIndex:Y,totalLevels:G.value.length})}})})]})}),E4=O(({cssClasses:X})=>{const $=F`flex flex-column items-center justify-around ${X}`;return z.Div({onunmount:()=>D($),class:$,children:[z.Img({class:"mt3 pt4",src:"/assets/images/just_landed.png",height:"200"}),z.Div("Looks like, you just landed here!"),W4({cssClasses:"pt5",justifyCssClasses:"justify-around",label:"Add your first habit"})]})}),z4=O(({isOpen:X,habit:$,onClose:W,onDone:Q})=>{const J=F`Delete '${()=>$.value.title}'?`,Z=()=>{N1($.value.id),Q()};return YX({onUnmount:()=>D(J),cssClasses:"bn w-30-ns",isOpen:X,onTapOutside:W,content:z.Div({class:"pa3 f5",children:[z.Div({class:"mb3 b f4",children:J}),z.Div({class:"mb4",children:[`
              All the data and the achievements associated with this habit will be lost forever
              with this action, and cannot be reversed.
              `,z.Br({}),z.Br({}),`
              Are you sure, you want to DELETE this habit permanently?
              `]}),z.Div({class:"flex items-center justify-between f6",children:[p({cssClasses:"w-25 pv2 ph3 mr1 b",children:"No",onTap:W}),p({cssClasses:"pv2 ph3 ml2 b red",children:"Yes, delete permanently",onTap:Z})]})]})})}),T4=O(({isOpen:X,habit:$,date:W,showTitleInHeader:Q,onClose:J,onChange:Z})=>{const{title:Y,levels:G,tracker:R,colorIndex:_}=T($).props,B=U(()=>Q?.value?`Change status of  '${Y.value}'`:`Change status for ${W.value.toDateString()}`),P=C(Z0,R,W),K=T(G).length,j=U(()=>{const H=[...G.value];return H.reverse(),H.map((E,x)=>{const L=K.value-1-x,g=`pointer flex items-center pv3 pa3 bt b--moon-gray ${P.value?.level.code===L?"bg-near-white black fw6":"gray fw5"}`,d=`pa1 mr3 ba b ${L<1?"b--light-silver":"b--transparent"}`;return{levelName:E.name,levelCode:L,levelTileCSS:g,dotClasses:d}})});return YX({onUnmount:()=>D(Y,G,R,_,B,P,K,j),cssClasses:"f5 normal ba bw0 outline-0",isOpen:X,onTapOutside:J,content:z.Div({class:"mnw5",children:[z.Div({class:"f5 b tc pa3",children:B}),z.Div({class:"f5 mb1",children:z.For({subject:j,map:(H)=>{const{levelName:E,levelCode:x,levelTileCSS:L,dotClasses:I}=T(H).props;return z.Div({onunmount:()=>D(E,x,L,I),class:L,onclick:S(()=>Z(x.value)),children:[zX({cssClasses:I,colorIndex:_,level:x,totalLevels:G.value.length,isRectangular:!0}),z.Span(E)]})}})})]})})}),q4=O(({isOpen:X,habit:$,onClose:W,onDone:Q})=>{const J=F`Stop '${()=>$.value.title}'?`;return YX({onUnmount:()=>D(J),cssClasses:"bn",isOpen:X,onTapOutside:W,content:z.Div({class:"pa3 f5",children:[z.Div({class:"mb3 b f4",children:J}),z.Div({class:"mb4",children:["This action is not reversible. You will not be able to resume it again.",z.Br({}),z.Br({}),"Are you sure, you want to STOP this habit permanently?"]}),z.Div({class:"flex items-center justify-between f6",children:[p({cssClasses:"w-100 pv2 ph3 mr2",children:"No, go back",onTap:W}),p({cssClasses:"w-100 pv2 ph3 ml2 b",children:"Yes, stop this",onTap:Q})]})]})})}),G4=O(({cssClasses:X,links:$})=>{const W=F`flex items-center justify-between pv3 bg-near-white ${X}`;return z.Div({onunmount:()=>D(W),class:W,children:z.For({subject:$,map:(Q)=>R4({label:Q.label,icon:Q.icon,isSelected:Q.isSelected,href:Q.href})})})}),R4=O(({cssClasses:X,label:$,icon:W,isSelected:Q,href:J})=>{const Z=w(Q).ternary("app-theme-color b","black"),Y=F`pointer noselect flex flex-column items-center justify-center pb2 ${Z} ${X}`;return z.Div({onunmount:()=>D(Z,Y),class:Y,onclick:S(()=>e0(J.value)),children:[b({size:22,iconName:W}),z.Div({class:"f7",children:$})]})}),H4=O(({cssClasses:X,header:$,content:W,navbarTop:Q,route:J})=>{return B0({cssClasses:X,header:$,content:W,bottombar:z.Div({children:[z.If({subject:Q,isTruthy:()=>Q}),G4({cssClasses:"nl3 nr3 ph4",links:C(C1,J)})]})})}),U4=O(({cssClasses:X,body:$,onMount:W,onUnMount:Q})=>{const J=V("stylesheet");return z.Html({lang:"en",children:[z.Head({onmount:()=>J.value="stylesheet",children:[z.Meta({"http-equiv":"Content-Security-Policy",content:`
                default-src 'self';
                script-src 'self';
                style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://unpkg.com;
                font-src https://fonts.gstatic.com;
                object-src 'none';
                base-uri 'none';
              `}),z.Meta({charset:"UTF-8"}),z.Meta({"http-equiv":"X-UA-Compatible",content:"IE=edge"}),z.Meta({name:"viewport",content:"width=device-width, initial-scale=1.0"}),z.Link({rel:"icon",type:"image/x-icon",href:"/assets/images/favicon.ico"}),z.Link({rel:J,href:"/assets/styles.css",as:"style"}),z.Link({rel:"manifest",href:"/manifest.json"}),z.Title("Habits (by Cyfer)")]}),z.Body({tabindex:"-1",class:X,onmount:W,onunmount:Q,children:[z.Script({src:"main.js",defer:!0}),$]})]})}),r=O(({cssClasses:X,contentCssClasses:$,title:W,description:Q,hideDescription:J,children:Z})=>{const Y=F`mt3 mb4 ${X}`,G=w(Q).andNot(J).truthy;return z.Div({onunmount:()=>D(Y,G),class:Y,children:[z.Div({class:"mb2 dark-gray f4 b",children:W}),z.If({subject:G,isTruthy:()=>z.Div({class:"mb3 f6 silver fw5",children:Q})}),z.Div({class:$,children:Z})]})}),w4=O(({cssClasses:X,iconSize:$,selectedOptionIndex:W,onChange:Q})=>{const J=V(!1),Z=U(()=>wX[W.value]),Y=T(Z).prop("decending"),G=T(Z).prop("icon"),R=T($).or(20),_=()=>J.value=!0,B=()=>J.value=!1,P=(j)=>j===Z.value.label?"bg-near-white black fw6":"gray fw5",K=(j)=>{Q(j),B()};return z.Div({onunmount:()=>D(Z,Y,G,R),class:X,children:[yX({cssClasses:"pointer",descending:Y,iconName:G,size:R,onClick:_}),YX({cssClasses:"f5 normal ba bw0 outline-0",isOpen:J,onTapOutside:B,content:z.Div({children:[z.Div({class:"f5 b tc pv3",children:"Sort habit cards by"}),z.Div({class:"f5 mb1",children:z.For({subject:wX,map:(j,N)=>z.Div({class:`pointer flex items-center pv3 pl2 pr3 bt b--moon-gray ${P(j.label)}`,onclick:S(()=>K(N)),children:[yX({cssClasses:"ml1 mr2",descending:j.decending,iconName:j.icon,size:20}),z.Span(j.label)]})})})]})})]})}),yX=O(({cssClasses:X,descending:$,iconName:W,size:Q,onClick:J})=>{const Z=J?"pointer":"",Y=w($).ternary("arrow_upward","arrow_downward"),G=w(Q).mul(4).div(5).result;return z.Span({class:F`flex items-center ${Z} ${X}`,onclick:S(J),children:[b({cssClasses:"silver",iconName:Y,size:G}),b({size:Q,iconName:W})]})}),x4=O(({cssClasses:X,progress:$})=>{const W=F`flex flex-column justify-center items-center vh-100 ${X}`;return z.Div({onunmount:()=>D(W),class:W,children:[z.Img({class:"mt6 br4",src:"/assets/images/habits-logo.png",height:"100",width:"100"}),z.Div({class:"f3 b mv3",children:"Habits"}),Q4({cssClasses:"w-40",progress:$}),z.Div({class:"mt7 pv4",children:"A Cyfer Product"})]})}),f4=O(({date:X,selectedDate:$,onChange:W})=>{const Q=C(V0,X),J=C(AX,$,X),Z=w(Q).ternary("light-gray b--transparent","light-silver pointer b--transparent"),Y=w(J).ternary("black b b--silver",Z),G=F`bw1 ba br-pill ph2 pv3 pb2 tc ${Y}`,R=U(()=>CX(X.value.getDay(),3)),_=U(()=>("0"+X.value.getDate()).slice(-2)),B=()=>{if(J.value||Q.value)return;W(X.value)},P=()=>D(Q,J,Z,Y,G,R,_);return z.Div({onunmount:P,class:G,onclick:S(B),children:[z.Div({class:"f7 ",children:R}),z.Div({class:"mt2 f4",children:_})]})}),_4=O(({cssClasses:X,editableHabit:$,editedHabit:W,hideDescriptions:Q,showFullCustomisations:J,onChange:Z})=>{const Y=V(!1),G=T(J).or(Y),{title:R,frequency:_,levels:B,milestones:P,colorIndex:K}=T(W).props,j=T(_).every((k)=>!!k),E=w(j).ternary("bg-mid-gray white","bg-near-white light-silver"),x=w(Y).ternary("remove","add"),L=F`Show ${w(Y).ternary("Less","More")} Customisations`,I=(k)=>{Z({...W.value,title:k})},g=(k)=>{Z({...W.value,colorIndex:k})},c=(k)=>{if(k<-1||k>6)throw"Invalid day index";if(k===-1){Z({...W.value,frequency:[1,1,1,1,1,1,1]});return}const A=j.value?_.value.map((f)=>0):_.value;A[k]=j.value?1:A[k]?0:1,Z({...W.value,frequency:A})},d=(k,A)=>{const f=B.value;f[A]={...f[A],name:k},Z({...W.value,levels:f})},s=(k)=>{const A=B.value;A.splice(k,0,{isMaxLevel:!1,name:"",code:k}),Z({...W.value,levels:xX(A)})},a=(k)=>{const A=B.value;if(A.length<3)return;A.splice(k,1),Z({...W.value,levels:xX(A)})},t=(k,A)=>{if(A<0||A>2)throw"Incorrect index of milestone passed. Milestone values should not be more than 3.";const f=[...W.value.milestones];f[A]={...f[A],percent:k},Z({...W.value,milestones:f})};return z.Div({class:X,children:[r({cssClasses:"pb1",title:"Weekdays",children:z.Div({class:"mb3 f6 flex items-center justify-between justify-start-ns",children:z.For({subject:Array(7).fill(0),n:0,nthChild:z.Span({class:F`pointer flex items-center justify-center br-pill h2 ph2 mr3-ns ${E}`,children:"Daily",onclick:S(()=>c(-1))}),map:(k,A)=>{const f=U(()=>_.value[A]&&!j.value?"bg-mid-gray white":"bg-near-white light-silver");return z.Span({class:F`pointer flex items-center justify-center br-100 h2 w2 mr3-ns ${f}`,children:CX(A,1),onclick:S(()=>c(A))})}})})}),r({cssClasses:"pb2",title:"Title of the habit",children:VX({cssClasses:"ba bw1 b--light-silver br3 pa2 w-100",placeholder:'for example, "wake up at 5am"',text:R,onchange:I})}),z.If({subject:G,isTruthy:()=>z.Div([r({cssClasses:"pb1",title:"Select a color tag",children:z.Div({class:"mb1 flex items-center",children:z.For({subject:hX,map:(k,A)=>{const f=w(K).equals(A).ternary("#999","#f4f4f4");return z.Span({class:"pointer mb2 mr3 pa1 br-100 bw2 ba flex",style:F`border-color: ${f}`,onclick:S(()=>g(A)),children:z.Span({class:F`pa2 br-100`,style:`background-color: ${k}`})})}})})}),r({cssClasses:"pb3",title:"Status update levels",hideDescription:Q,description:`
                  When updating a habit status in a day, we generally have only two levels - "${BX[0]}"
                  or "${BX[1]}". But a habit can have more than 2 levels as well.
                  Like for example, the habit of 'Drink 2 litres water daily'
                  should ideally have three levels - '0 litre', '1 litre' and '2 litres', from low to high.
                  You can add or remove levels by clicking on + or - buttons. Click on textbox
                  for editing the status level name. The levels from top to bottom should go from lowest
                  to the highest.`,children:z.For({subject:B,map:(k,A)=>{const f=$?.value?.levels||[],DX=B.value,{hideAddButton:K0,hideRemoveButton:P0}=S1(f,DX,A),j0=L1(f,DX,A);return z.Div({children:[z.Div({class:"flex items-center justify-between",children:[z.Div({class:"flex items-center ba bw1 b--light-silver br3 w-70 w-80-ns",children:[zX({cssClasses:"w1 h2 br3 br--left ml1px",dotCssClasses:"br3 br--left",colorIndex:K,level:A,isRectangular:!0,totalLevels:B.value.length}),VX({cssClasses:"bn pa2 br3 w-100 outline-0",placeholder:`Level ${A}`,disabled:j0,text:k.name,onchange:(A0)=>d(A0,A)})]}),X4({hideAdd:K0,hideRemove:P0,onAdd:()=>s(A+1),onRemove:()=>a(A)})]}),z.If({subject:w(B).lengthGT(A+1).truthy,isTruthy:()=>z.Div({class:"pa2 ml2 pl1 bl bw1 b--silver"})})]})}})}),r({title:"Habit completion goal",hideDescription:Q,description:F`
                  Goals are something for long-term. Let's say based on below table, after
                  a month or two, you followed your habit for 67% of the times, then you
                  just crossed the milestone - '${()=>Y0(W.value.milestones,67).label}'. For achieving your goal (in %), you can set your
                  own custom milestones depending on the difficulty of the habit.`,children:z.For({subject:P,n:0,nthChild:z.Div({class:"mb1 ph2 pv0 bn bw1 relative ts-white-1",children:[z.Span({class:"lh-copy",children:""}),z.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[z.Span({class:"w-100 bg-white bn bw1 ph2dot5 di f4 b light-silver pb3 nl1",children:"100"}),z.Span({class:"ph2 bg-white light-silver b pb3 mr1",children:"%"})]})]}),map:(k,A)=>z.Div({class:"mb1 ph4 pv4 ba br3 bw1 b--light-gray relative",children:[z.Span({class:"lh-copy flex items-center",children:[b({cssClasses:`mr2 ${k.color}`,size:20,iconName:k.icon}),k.label]}),z.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[z.If({subject:A===3,isTruthy:()=>z.Span({class:"w-100 bg-white bn bw1 br3 pa2dot5 di f4 b light-silver mb1",children:"00"}),isFalsy:()=>$4({cssClasses:"w-100 ba bw1 b--light-silver br3 pa2dot5 di f5 b dark-gray",num:k.percent,onchange:(f)=>t(f,A)})}),z.Span({class:"ph2 bg-white light-silver b",children:"%"})]})]})})})])}),z.If({subject:J,isFalsy:()=>p({cssClasses:"pv2 ph3 flex items-center",onTap:()=>Y.value=!Y.value,children:[b({cssClasses:"mr1",iconName:x}),L]})})]})}),B4=O(({editableHabit:X,onMount:$})=>{const W=V($X.editPage),Q=V(!1),J=V(!1),Z=V(""),Y=V(H1()),G=C((I)=>I?`Edit '${I.title}'`:"Add new habit",X),R=w(G).lengthGT(22).ternary("f2dot66",""),_=w(X).ternary("Update","Add"),B=()=>Q.value=!0,P=()=>Q.value=!1,K=()=>{P(),history.go(-2)},j=()=>J.value=!0,N=()=>J.value=!1,H=()=>{A1(Y.value),N(),history.back()},E=(I)=>Y.value=I,x=()=>{if(Z.value=f1(Y.value,!X?.value),Z.value)return;const I=Y.value,g=[...X?.value?.levels||[]],c=g1(g,I.levels,I.tracker);W0({...Y.value,tracker:c}),history.back()};return U4({onMount:()=>{if($)$(),Y.value=X?.value;W.value=P1()},body:B0({cssClasses:"bg-white ph3",header:z.Div({class:R,children:G}),content:z.Div([z.If({subject:X,isTruthy:()=>z.Div([r({cssClasses:"pb2",title:"Actions",children:[z4({isOpen:Q,habit:Y,onClose:P,onDone:K}),IX({cssClasses:"db mb3 f6 red",children:"Delete this habit permanently along with its data",onClick:B}),q4({isOpen:J,habit:Y,onClose:N,onDone:H}),IX({cssClasses:"db mb3 f6 gray",children:"Stop this habit permanently and keep it for future",onClick:j})]})])}),_4({editableHabit:X,editedHabit:Y,hideDescriptions:U(()=>!W.value.showHints),showFullCustomisations:T(W).prop("showFullCustomisation"),onChange:E})]),bottombar:z.Div({class:"bg-white w-100 pv3",children:[z.If({subject:Z,isTruthy:()=>z.Div({class:"red mb3",children:Z})}),z.Div({class:"flex items-center justify-stretch",children:[J4({cssClasses:"w4dot50 w4dot25-ns"}),p({cssClasses:"w-100 pa3 ml3 b",children:_,onTap:x})]})]})})})}),F0=V(void 0),F4=()=>{const X=M1();if(!X)throw"Invalid habit ID in query params. No habit fetched.";F0.value=X},K4=B4({editableHabit:F0,onMount:F4}),P4=()=>{y.start("mount"),pX.resetIdCounter(),K4(),y.start("run")};P4();
