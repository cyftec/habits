var UQ=(Q)=>{const X=Object.entries(Q).sort((W,$)=>W[0].localeCompare($[0]));return X.forEach(([W,$],J)=>{if($&&typeof $==="object"&&!Array.isArray($))X[J]=[W,UQ($)]}),Object.fromEntries(X)},WQ=(Q)=>{if(typeof Q!=="object"||Q===null||Array.isArray(Q))return!1;return Object.prototype.toString.call(Q)==="[object Object]"},QQ=(Q)=>{if(Array.isArray(Q)){const X=[...Q],W=[];return X.forEach(($)=>{W.push(QQ($))}),W}if(WQ(Q)){const X={...Q},W={};return Object.keys(X).forEach(($)=>{W[$]=QQ(X[$])}),Object.freeze(W)}return Q},i=(Q)=>{if(Array.isArray(Q)){const W=[...Q],$=[];return W.forEach((J)=>{$.push(i(J))}),$}if(WQ(Q)){const W={...Q},$={};return Object.keys(W).forEach((J)=>{$[J]=i(W[J])}),$}return Q},EQ=(Q,X="index")=>Q.map((W,$)=>({[X]:$,value:W})),jX=(Q,X)=>{const W=UQ(Q),$=UQ(X),J=Object.keys(W),Z=Object.keys($);if(J.length!==Z.length)return!1;for(let Y of J)if(!Z.includes(Y)||!KQ(W[Y],$[Y]))return!1;return!0},AX=(Q,X)=>{if(Q.length!==X.length)return!1;if(Q.length===0)return!0;for(let W=0;W<Q.length;W++)if(!KQ(Q[W],X[W]))return!1;return!0},KQ=(Q,X)=>{if(typeof Q!==typeof X)return!1;if(Array.isArray(Q))return AX(Q,X);if(Q===null||X===null)return Q===X;if(typeof Q==="object"&&!(Q instanceof Set))return jX(Q,X);if(typeof Q==="bigint"||typeof Q==="number"||typeof Q==="string"||typeof Q==="boolean")return Q===X;return Q===X},NX=(Q,X,W)=>{const J=EQ(i(Q),"index");return EQ(i(X),"index").map((Y)=>{let G="add",U=-1;const _=Y.value;return J.some((B,P)=>{if(G=KQ(B.value,Y.value)?B.index===Y.index?"idle":"shuffle":W&&B.value[W]!==void 0&&B.value[W]===Y.value[W]?"update":"add",G!=="add")return U=B.index,J.splice(P,1),!0;return!1}),{type:G,oldIndex:U,value:_}})},OX=(Q)=>{const X=(W)=>Q(($)=>{const J=Array.from($);return W(J),J});return{copyWithin:(...W)=>X(($)=>$.copyWithin(...W)),fill:(...W)=>X(($)=>$.fill(...W)),pop:(...W)=>X(($)=>$.pop(...W)),push:(...W)=>X(($)=>$.push(...W)),remove:(...W)=>{const $=W[0],J=(...Z)=>!$(...Z);W[0]=J,Q((Z)=>{return Z.filter(...W)})},reverse:(...W)=>X(($)=>$.reverse(...W)),shift:(...W)=>X(($)=>$.shift(...W)),sort:(...W)=>X(($)=>$.sort(...W)),splice:(...W)=>X(($)=>$.splice(...W)),unshift:(...W)=>X(($)=>$.unshift(...W))}},MX=(Q)=>{return{set:(X)=>Q((W)=>({...W,...X}))}},RQ=null,TQ=(Q)=>RQ=Q,V=(Q)=>{let X=QQ(Q);const W=new Set,$=()=>{W.forEach((Y)=>{if(Y.canDisposeNow){W.delete(Y);return}Y()})},J=(Y)=>{X=Y,$()},Z={type:"source-signal",get value(){if(RQ)W.add(RQ);return i(X)},set value(Y){if(Y===X)return;J(QQ(Y))}};return Array.isArray(Q)?Object.assign(Z,OX((Y)=>J(Y(X)))):typeof Q==="object"&&Q!==null?Object.assign(Z,MX((Y)=>J(Y(X)))):Z},n=(Q)=>{const X=Q;return X.canDisposeNow=!1,X.dispose=()=>{X.canDisposeNow=!0},TQ(X),Q(),TQ(null),X},R=(Q)=>{let X;const W=V(X),$=n(()=>{X=Q(X),W.value=X});return{type:"derived-signal",get prevValue(){return X},get value(){return W.value},dispose(){$.dispose()}}},D=(...Q)=>{Q.forEach((X)=>X.dispose())},kX=(Q)=>{return{type:"non-signal",value:Q}},z=(Q)=>ZQ(Q)?Q.value:Q,v=(Q)=>["source-signal","derived-signal"].includes(Q?.type),JQ=(Q,X)=>Q?.type==="non-signal"&&(!X||!X.length||X.some((W)=>typeof Q?.value===W)),ZQ=(Q)=>v(Q)||JQ(Q),C=(Q,...X)=>{return R(()=>{const W=X.map(($)=>z($));return Q(...W)})},M=(Q)=>{const X=typeof Q==="function"?Q:()=>z(Q);return{...{get truthy(){return R(()=>!!X())},get falsy(){return R(()=>!X())},get truthyFalsyPair(){return R(()=>{const $=!!X();return[$,!$]})},ternary:($,J)=>R(()=>{return X()?z($):z(J)})},or:($)=>M(()=>{return!!(X()||z($))}),orNot:($)=>M(()=>{return!!(X()||!z($))}),and:($)=>M(()=>{return!!(X()&&z($))}),andNot:($)=>M(()=>{return!!(X()&&!z($))}),equals:($)=>M(()=>{return X()===z($)}),notEquals:($)=>M(()=>{return X()!==z($)}),orBothEqual:($,J)=>M(()=>{const Z=X(),Y=z($)===z(J);return!!(Z||Y)}),orBothUnequal:($,J)=>M(()=>{const Z=X(),Y=z($)!==z(J);return!!(Z||Y)}),andBothEqual:($,J)=>M(()=>{const Z=X(),Y=z($)===z(J);return!!(Z&&Y)}),andBothUnequal:($,J)=>M(()=>{const Z=X(),Y=z($)!==z(J);return!!(Z&&Y)}),orThisIsLT:($,J)=>M(()=>{const Z=X(),Y=z($)<z(J);return!!(Z||Y)}),orThisIsLTE:($,J)=>M(()=>{const Z=X(),Y=z($)<=z(J);return!!(Z||Y)}),orThisIsGT:($,J)=>M(()=>{const Z=X(),Y=z($)>z(J);return!!(Z||Y)}),orThisIsGTE:($,J)=>M(()=>{const Z=X(),Y=z($)>=z(J);return!!(Z||Y)}),andThisIsLT:($,J)=>M(()=>{const Z=X(),Y=z($)<z(J);return!!(Z&&Y)}),andThisIsLTE:($,J)=>M(()=>{const Z=X(),Y=z($)<=z(J);return!!(Z&&Y)}),andThisIsGT:($,J)=>M(()=>{const Z=X(),Y=z($)>z(J);return!!(Z&&Y)}),andThisIsGTE:($,J)=>M(()=>{const Z=X(),Y=z($)>=z(J);return!!(Z&&Y)})}},u=(Q)=>{const X=typeof Q==="function"?Q:()=>z(Q);return{...M(Q),get result(){return R(X)},add:(W)=>u(()=>{return X()+z(W)}),sub:(W)=>u(()=>{return X()-z(W)}),mul:(W)=>u(()=>{return X()*z(W)}),div:(W)=>u(()=>{return X()/z(W)}),mod:(W)=>u(()=>{return X()%z(W)}),pow:(W)=>u(()=>{return X()**z(W)}),isBetween:(W,$,J=!0,Z=!0)=>M(()=>{const Y=X(),G=z(W),U=z($),_=J?Y>=G:Y>G,B=Z?Y<=U:Y<U;return _&&B}),isLT:(W)=>M(()=>X()<z(W)),isLTE:(W)=>M(()=>X()<=z(W)),isGT:(W)=>M(()=>X()>z(W)),isGTE:(W)=>M(()=>X()>=z(W))}},DX=(Q)=>{const X=typeof Q==="function"?Q:()=>z(Q);return{...M(Q),lengthBetween:(W,$,J=!0,Z=!0)=>M(()=>{const G=X().length,U=z(W),_=z($),B=J?G>=U:G>U,P=Z?G<=_:G<_;return B&&P}),lengthEquals:(W)=>M(()=>{return X().length===z(W)}),lengthNotEquals:(W)=>M(()=>{return X().length!==z(W)}),lengthLT:(W)=>M(()=>{return X().length<z(W)}),lengthLTE:(W)=>M(()=>{return X().length<=z(W)}),lengthGT:(W)=>M(()=>{return X().length>z(W)}),lengthGTE:(W)=>M(()=>{return X().length>=z(W)})}},w=(Q)=>{const W=(typeof Q==="function"?Q:()=>z(Q))();return typeof W==="number"?u(Q):typeof W==="string"||Array.isArray(W)?DX(Q):M(Q)},PQ=(...Q)=>Q.map((X)=>z(X)),l=(Q)=>{return{get string(){return R(()=>{const X=z(Q);return X===void 0||X===null?void 0:X.toString()})},or:(X)=>R(()=>z(Q)||z(X))}},EX=(Q)=>{const W=["at","copyWithin","fill","includes","indexOf","join","lastIndexOf","slice","with"].reduce(($,J)=>{const Z=(...Y)=>{return R(()=>{const G=PQ(...Y);return z(Q)[J](...G)})};return $[J]=Z,$},{});return{...l(Q),...W,concat:($)=>R(()=>z(Q).concat(z($))),every:($)=>R(()=>z(Q).every($)),filter:($)=>R(()=>z(Q).filter($)),find:($)=>R(()=>z(Q).find($)),findIndex:($)=>R(()=>z(Q).findIndex($)),findLast:($)=>R(()=>z(Q).findLast($)),findLastIndex:($)=>R(()=>z(Q).findLastIndex($)),get lastItem(){return R(()=>{return i(z(Q)).pop()})},get length(){return R(()=>z(Q).length)},map:($)=>R(()=>z(Q).map($)),partition:($)=>{const J=R(()=>z(Q).filter($)),Z=R(()=>z(Q).filter((Y,G,U)=>!$(Y,G,U)));return[J,Z]},reduce:($,J)=>R(()=>z(Q).reduce($,J)),reduceRight:($,J)=>R(()=>z(Q).reduceRight($,J)),get reversed(){return R(()=>z(Q).toReversed())},some:($)=>R(()=>z(Q).every($)),toSorted:($)=>R(()=>z(Q).toSorted($)),toSpliced:($,J,...Z)=>R(()=>z(Q).toSpliced(z($),z(J),...Z))}},TX=(Q)=>{const W=["toExponential","toFixed","toPrecision"].reduce(($,J)=>{const Z=(...Y)=>{return R(()=>{const G=PQ(...Y);return z(Q)[J](...G)})};return $[J]=Z,$},{});return{...l(Q),...W,toConfined:($,J)=>R(()=>z(Q)<z($)?z($):z(Q)>z(J)?z(J):z(Q)),toLocaleString:($,J)=>R(()=>z(Q).toLocaleString(z($),J))}},HX=(Q)=>{if(!WQ(z(Q)))throw new Error("Thee argument should be a plain object or a signal of plain object");return{...l(Q),prop:(X)=>R(()=>z(Q)[X]),get props(){return Object.keys(z(Q)).reduce((W,$)=>{const J=$;return W[J]=this.prop(J),W},{})},get keys(){return R(()=>Object.keys(z(Q)))}}},gQ=(Q)=>{const W=["at","charAt","charCodeAt","codePointAt","concat","endsWith","includes","indexOf","lastIndexOf","padEnd","padStart","repeat","slice","startsWith","substring","trim","trimEnd","trimStart"].reduce(($,J)=>{const Z=(...Y)=>{return R(()=>{const G=PQ(...Y);return z(Q)[J](...G)})};return $[J]=Z,$},{});return{...l(Q),...W,get length(){return R(()=>z(Q).length)},get lowercase(){return R(()=>z(Q).toLowerCase())},get Sentencecase(){return R(()=>{const $=z(Q);return $.charAt(0).toUpperCase()+$.slice(1).toLowerCase()})},get TitleCase(){return R(()=>z(Q).toLowerCase().replace(/\b\w/g,($)=>$.toUpperCase()))},get UPPERCASE(){return R(()=>z(Q).toUpperCase())},localeCompare:($,J,Z)=>R(()=>z(Q).localeCompare(z($),z(J),Z)),normalize:($)=>R(()=>z(Q).normalize(z($))),replace:($,J)=>R(()=>z(Q).replace(z($),z(J))),replaceAll:($,J)=>R(()=>z(Q).replaceAll(z($),z(J))),search:($)=>R(()=>z(Q).search($)),split:($,J)=>R(()=>{const Z=$ instanceof RegExp?$:z($);return z(Q).split(Z,z(J))}),toLocaleLowerCase:($)=>R(()=>z(Q).toLocaleLowerCase(z($))),toLocaleUpperCase:($)=>R(()=>z(Q).toLocaleUpperCase(z($)))}},wX=V("dksjfbksjnd"),B1=gQ(wX).split(""),T=(Q)=>{return typeof z(Q)==="number"?TX(Q):typeof z(Q)==="string"?gQ(Q):Array.isArray(z(Q))?EX(Q):WQ(z(Q))?HX(Q):l(Q)},F=(Q,...X)=>R(()=>{return Q.reduce((W,$,J)=>{let Z;const Y=X[J];if(typeof Y==="function")Z=Y()??"";else if(ZQ(Y))Z=Y.value??"";else Z=Y??"";return`${W}${$}${Z.toString()}`},"")}),CQ=["onmount","onunmount"],bQ=["onerror","onload","onresize","onblur","onchange","oncontextmenu","onfocus","oninput","oninvalid","onreset","onselect","onsubmit","onkeydown","onkeypress","onkeyup","onclick","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onscroll","onabort","oncanplay","oncanplaythrough","ondurationchange","onemptied","onended","onerror","onloadeddata","onloadedmetadata","onloadstart","onpause","onplay","onplaying","onprogress","onratechange","onseeked","onseeking","onstalled","onsuspend","ontimeupdate","onvolumechange","onwaiting"],xX=[...bQ,...CQ],fX=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],e,hQ=(Q)=>{if(!e)e=document.createElement("textarea");return e.innerHTML=Q,e.value},SX=(Q)=>{try{return decodeURIComponent(Q)}catch{return Q}},LX=(Q)=>{return Q.replace(/\\u[\dA-Fa-f]{4}/g,(X)=>String.fromCharCode(parseInt(X.slice(2),16))).replace(/\\x[\dA-Fa-f]{2}/g,(X)=>String.fromCharCode(parseInt(X.slice(2),16)))},IX=()=>{let Q=0;return{getNewId:()=>++Q,resetIdCounter:()=>Q=0}},vQ=IX(),y={currentIs:(Q)=>window._currentAppPhase===Q,start:(Q)=>{window._currentAppPhase=Q,console.log(`Current phase is ${Q}`)}},cQ=(Q,X,W)=>{let $=Q;$=hQ($),$=SX($),$=LX($);const J=$.trim().toLowerCase();for(let Z of X)if(Z.test(J))throw W;return Q},VX=(Q)=>cQ(Q,[/^javascript\s*:/i,/^data\s*:/i,/^vbscript\s*:/i,/^file\s*:/i],'The href attribute value starting with one of "javascript:", "data:", "vbscript:" or "file:" is not allowed.'),yX=(Q)=>cQ(Q,[/url\s*\(/i,/expression\s*\(/i,/javascript\s*:/i,/data\s*:/i,/vbscript\s*:/i,/file\s*:/i],'The style attribute value starting with one of "url(..", "expression(..", "javascript:", "data:", "vbscript:" or "file:" is not allowed.'),gX=(Q,X)=>{if(Q==="href"){if(typeof X==="boolean")throw"The value of 'href' attribute should not be a boolean";return VX(X||"")}if(Q==="style"){if(typeof X==="boolean")throw"The value of 'style' attribute should not be a boolean";return yX(X||"")}return X},jQ=(Q)=>Array.isArray(Q),XQ=(Q)=>!isNaN(Q?.elementId)&&Q?.elementId>0,h=(Q)=>Q===void 0||typeof Q==="string"||typeof Q==="function"&&Q.isElementGetter,mQ=(Q)=>jQ(Q)&&Q.every((X)=>h(X)),pQ=(Q)=>h(Q)||mQ(Q),uQ=(Q)=>JQ(Q)&&h(Q.value),_Q=(Q)=>v(Q)&&h(Q.value),CX=(Q)=>JQ(Q)&&pQ(Q.value),dQ=(Q)=>v(Q)&&pQ(Q.value),rQ=(Q)=>jQ(Q)&&Q.every((X)=>h(X)||uQ(X)||_Q(X)),bX=(Q)=>!v(Q)&&(h(Q)||CX(Q)||rQ(Q)),oQ=(Q)=>bX(Q)||dQ(Q),HQ=!1,hX={},o={},vX=globalThis.MutationObserver,cX=new vX((Q)=>{Q.forEach((X)=>{if(X.type==="childList")X.addedNodes.forEach((W)=>{if(XQ(W)){const $=W,J=$.elementId;if(o[J])delete o[J];else hX[J]=$.tagName}}),X.removedNodes.forEach((W)=>{if(XQ(W)){const $=W,J=$.elementId,Z=$.unmountListener;if(Z)o[J]={element:$,unmountListener:Z}}})}),Object.entries(o).forEach(([X,W])=>{const{element:$,unmountListener:J}=W;iQ($,J)})}),iQ=(Q,X)=>{if(!XQ(Q))return;const W=Q.children;for(let $=0;$<W.length;$++){const J=W[$];iQ(J,J.unmountListener)}if(X&&X(Q),o[Q.elementId])delete o[Q.elementId]},mX=()=>{if(!HQ&&!y.currentIs("build"))cX.observe(document.body,{childList:!0,subtree:!0}),HQ=!0},sQ=(Q,X)=>xX.includes(Q)&&X===void 0,nQ=(Q,X)=>bQ.includes(Q)&&typeof X==="function",lQ=(Q,X)=>CQ.includes(Q)&&typeof X==="function",pX=(Q,X)=>sQ(Q,X)||nQ(Q,X)||lQ(Q,X),uX=(Q,X)=>{Object.entries(X).forEach(([W,$])=>{if(sQ(W,$));else if(nQ(W,$)){const J=W.slice(2);Q.addEventListener(J,(Z)=>{if(J==="keypress")Z.preventDefault();$(Z)})}else if(lQ(W,$)){if(W==="onmount"&&!y.currentIs("build")){const J=$;setTimeout(()=>J(Q),0)}if(W==="onunmount"){mX();const J=Q.unmountListener;Q.unmountListener=(Z)=>{if($(Z),typeof J==="function")J(Z)}}}else console.error(`Invalid event key: ${W} for element with tagName: ${Q.tagName}`)})},wQ=(Q,X,W)=>{const $=ZQ(W)?W.value:W,J=gX(X,$);if(typeof J==="boolean")if(J)Q.setAttribute(X,"");else Q.removeAttribute(X);else if(X==="value")Q.value=J||"";else Q.setAttribute(X,J||"")},dX=(Q,X)=>{const W={};Object.entries(X).forEach((J)=>{const[Z,Y]=J;if(v(Y))W[Z]=Y;wQ(Q,Z,Y)});const $=n(()=>{Object.entries(W).forEach((J)=>{const[Z,Y]=J,G=Y.value;if(!y.currentIs("run"))return;wQ(Q,Z,G)})});Q.effects.push($)},rX=(Q)=>{if(!Q||typeof Q==="string")return document.createTextNode(hQ(Q||""));if(h(Q)){const X=Q();if(!XQ(X))throw new Error(`Invalid MHtml element getter child. Type: ${typeof Q}`);return X}throw new Error(`Invalid child. Type of child: ${typeof Q}`)},zQ=(Q,X,W)=>{const $=Q.childNodes[W],J=rX(X);if($&&J)Q.replaceChild(J,$);else if(J)Q.appendChild(J);else console.error(`No child found for node with tagName: ${Q.tagName}`)},oX=(Q,X)=>{if(!X)return;if(dQ(X)){const J=n(()=>{const Z=X.value,Y=jQ(Z)?Z:[Z];Y.forEach((U,_)=>zQ(Q,U,_));const G=Y.length;while(G<Q.childNodes.length){const U=Q.childNodes[G];if(U)Q.removeChild(U)}});Q.effects.push(J)}const W=h(X)?[X]:JQ(X)?h(X.value)?[X.value]:mQ(X.value)?X.value:[]:rQ(X)?X.map((J)=>_Q(J)?J:uQ(J)?J.value:J):[],$=[];if(W.forEach((J,Z)=>{if(_Q(J))$.push({index:Z,signalChild:J});const Y=z(J);zQ(Q,Y,Z)}),$.length)$.forEach(({index:J,signalChild:Z})=>{const Y=n(()=>{const G=Z.value;if(!y.currentIs("run"))return;zQ(Q,G,J)});Q.effects.push(Y)})},iX=(Q,X)=>{let W=void 0;const $={},J={};return Object.entries(Q).forEach(([Z,Y])=>{if(Z==="children")if(oQ(Y))W=Y;else throw new Error(`Invalid children prop for node with tagName: ${X}\n\n ${JSON.stringify(Y)}`);else if(pX(Z,Y))$[Z]=Y;else J[Z]=Y}),{children:W,eventProps:$,attributeProps:J}},sX=(Q,X)=>{const W=()=>{const $=vQ.getNewId(),J=y.currentIs("mount")?document.querySelector(`[data-elem-id="${$}"]`):document.createElement(Q);J.elementId=$,J.effects=[],J.unmountListener=()=>{J.effects.forEach((G)=>G.dispose())};const Z=oQ(X)?{children:X}:X;if(!y.currentIs("run"))Z["data-elem-id"]=J.elementId.toString();const Y=iX(Z,J.tagName);if(uX(J,Y.eventProps),dX(J,Y.attributeProps),oX(J,Y.children),!y.currentIs("build"))J.removeAttribute("data-elem-id");return J};return W.isElementGetter=!0,W},xQ=(Q,X,W)=>{const $=V(X),J=V(Q),Z=W(R(()=>J.value),R(()=>$.value));let Y,G,U=!1;if(Z?.isElementGetter)Y=()=>{if(U&&G)return G;return G=Z(),U=!0,G},Y.isElementGetter=!0;else if(!Z||typeof Z==="string")Y=Z||"";else throw`One of the child, ${Z} passed in ForElement is invalid.`;return{indexSignal:$,itemSignal:J,mappedChild:Y}},GQ=(Q,X,W)=>{if(X!==void 0&&X>=0&&W){const $=X>Q.length?Q.length:X;Q.splice($,0,W)}return Q},nX=({subject:Q,itemKey:X,map:W,n:$,nthChild:J})=>{if(J&&$===void 0||$!==void 0&&$>-1&&!J)throw new Error("Either both 'n' and 'nthChild' be passed or none of them.");let Z=J;if(J&&typeof J!=="string"){const K=J(),j=()=>K;j.isElementGetter=!0,Z=j}if(!v(Q))return GQ(z(Q).map(W),$,Z);const Y=R(()=>{const K=z(Q);return Array.isArray(K)?K:[]});if(!X)return R(()=>GQ(Y.value.map(W),$,Z));const G=Y.value;if(G.length&&typeof G[0]!=="object")throw new Error("for mutable map, item in the list must be an object");let U=null;const _=R((K)=>{return U=K||U,Y.value}),B=R((K)=>{if(!K||!U)return _.value.map((H,E)=>xQ(H,E,W));return NX(U,_.value,X).map((N,H)=>{const E=(K||[])[N.oldIndex];if(console.assert(N.type==="add"&&N.oldIndex===-1&&!E||N.oldIndex>-1&&!!E,"In case of mutation type 'add' oldIndex should be '-1', or else oldIndex should always be a non-negative integer."),E){if(N.type==="shuffle")E.indexSignal.value=H;if(N.type==="update")E.indexSignal.value=H,E.itemSignal.value={...N.value};return E}return xQ(N.value,H,W)})});return R(()=>GQ(B.value.map((K)=>K.mappedChild),$,Z))},lX=({subject:Q,isTruthy:X,isFalsy:W})=>{const $=q.Span({style:"display: none;"}),J=()=>z(Q)?X?X(Q):$:W?W(Q):$;return v(Q)?R(J):J()},aX=({subject:Q,caseMatcher:X,defaultCase:W,cases:$})=>{const J=()=>{const Z=z(Q),Y=z($);let G=void 0;for(let[U,_]of Object.entries(Y)){const B=X&&X(Z,U),P=`${Z}`===U;if(B||P){G=_();break}}return G||W&&W()||q.Span({style:"display: none;"})};return v(Q)?R(J):J()},tX=fX.reduce((Q,X)=>{const W=X.split("").map((J,Z)=>!Z?J.toUpperCase():J).join(""),$=(J)=>sX(X,J);return Q[W]=$,Q},{}),eX={For:nX,If:lX,Switch:aX},q={...tX,...eX},Q0=(Q)=>{const X=z(Q);return Array.isArray(X)&&X.some((W)=>ZQ(W))},O=(Q)=>(X)=>{for(let $ of Object.keys(X))if(X[$]===void 0)delete X[$];const W=Object.entries(X).reduce(($,J)=>{const[Z,Y]=J,G=v(Y)||typeof Y==="function"?Y:Q0(Y)?z(Y):kX(z(Y));return $[Z]=G,$},{});return Q(W)},aQ=["#e87b52","#F5E06F","#A3BA64","#7095C9","#A59EE3","#D89DBF"],X0=[1,1,1,1,1,1,1],$0=[{name:"Not Applicable",code:-1,isMaxLevel:!1},{name:"Paused",code:-2,isMaxLevel:!1},{name:"Stopped",code:-3,isMaxLevel:!1}],BQ=["Not started","Completed"],W0=[70,60,45],fQ={id:"analytics",lastInteraction:(new Date()).getTime()},$Q={id:"local-settings",habitsPage:{tabIndex:0,sortOptionIndex:0},editPage:{showHints:!0,showFullCustomisation:!1}},SQ=[{icon:"calendar_month",decending:!0,label:"Date created (Newest first)"},{icon:"calendar_month",decending:!1,label:"Date created (Oldest first)"},{icon:"task_alt",decending:!0,label:"Completion (Highest first)"},{icon:"task_alt",decending:!1,label:"Completion (Lowest first)"}];var FQ=86400000,J0=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Z0=["January","February","March","April","May","June","July","August","September","October","November","December"],tQ=(Q,X)=>J0[Q].substring(0,X),Y0=(Q,X)=>Z0[Q].substring(0,X),AQ=(Q)=>{return new Date(Q.getFullYear(),Q.getMonth(),Q.getDate())},m=(Q)=>AQ(Q).getTime(),NQ=(Q,X)=>m(Q)===m(X),q0=(Q,X)=>{const W=X||new Date;return m(Q)>m(W)},z0=(Q,X)=>{const W=m(Q),$=m(X);return Math.round(($-W)/FQ)},G0=(Q)=>z0(new Date,Q),eQ=(Q,X)=>new Date(Q.getFullYear(),Q.getMonth(),Q.getDate()+X),U0=(Q)=>{const X=new Date;return Array(Q).fill(0).map((W,$)=>new Date(X.getFullYear(),X.getMonth()-$,1)).reverse()},R0=(Q,X)=>{const W=m(Q),$=m(X);if(W===$)return[AQ(new Date(W))];const J=W<$?W:$,Y=((W<$?$:W)-J)/FQ;return Array(Y+1).fill(0).map((G,U)=>new Date(J+U*FQ))},_0=(Q)=>{if(Q<1)throw"";const X=new Date,W=X.getFullYear(),$=X.getMonth(),J=new Date(W,$-(Q-1),1),Z=new Date(W,$+1,0);return{startDate:J,endDate:Z}},QX={href:"/",HABITS:{href:"/habits/",NEW:{href:"/habits/new/"},HABIT:{href:"/habits/habit/",EDIT:{href:"/habits/habit/edit/"}}},SETTINGS:{href:"/settings/",PRIVACY_POLICY:{href:"/settings/privacy-policy/"}}},B0=(Q)=>location.href=Q,F0=()=>location.href=QX.HABITS.NEW.href,K0=(Q)=>location.href=`${QX.HABITS.HABIT.href}?id=${Q}`,P0=1.6181,j0=(Q)=>$0.find((X)=>X.code===Q),XX=(Q,X)=>{return Q<0?j0(-1):{isMaxLevel:Q===X.length-1,name:X[Q],code:Q}},A0=(Q)=>({key:Q.getTime(),level:XX(-1,[]),date:Q}),N0=(Q,X,W)=>({key:W.getTime(),level:XX(Q,X),date:W}),$X=(Q,X)=>Q.find((W)=>NQ(W.date,X)),OQ=(Q)=>{const X=AQ(new Date(Q.id));return{...Q,startDate:X,levels:Q.levels.map((W,$)=>({isMaxLevel:$===Q.levels.length-1,name:W,code:$})),tracker:Q.tracker.map((W,$)=>N0(W,Q.levels,eQ(X,$))),milestones:k0(Q.milestones)}},O0=(Q)=>{return{...Q,levels:Q.levels.map((X)=>X.name),tracker:Q.tracker.map((X,W)=>X.level.code),milestones:D0(Q.milestones)}},M0=()=>{const X={id:(new Date()).getTime(),title:"",frequency:X0,colorIndex:0,levels:BQ,tracker:[],milestones:W0,pauses:[],isStopped:!1};return OQ(X)},k0=(Q)=>[{label:"Successful",upperLimit:100,percent:Q[0],icon:"verified_user",color:"green"},{label:"Little more to go",upperLimit:Q[0],percent:Q[1],icon:"done_all",color:"light-blue"},{label:"Going good",upperLimit:Q[1],percent:Q[2],icon:"check",color:"blue"},{label:"Unacceptable",upperLimit:Q[2],percent:0,icon:"close",color:"red"}],D0=(Q)=>Q.filter((X)=>!!X.percent).map((X)=>X.percent),WX=(Q,X)=>{let W=Q[0];for(let $=0;$<Q.length;$++)if(W=Q[$],W.percent<=X)break;return{label:W.label,icon:W.icon,color:W.color}},E0=(Q,X)=>{if(!Q.title)return"Title should not be empty";if(X&&s0(Q.title))return"A habit with same name already exists";if(Q.frequency.every(($)=>!$))return"Select at least one day in a week";if(!Q.levels.every(($)=>!!$.name))return"One of the levels is empty";if(Q.levels.some(($,J)=>{for(let Z=J+1;Z<Q.levels.length;Z++)if(Q.levels[Z].name===$.name)return!0;return!1}))return"Multiple levels have same name";if(!Q.milestones.every(($)=>$.percent<=100&&$.percent>=0))return"The milestones should be between 0 and 100 percents";if(!Q.milestones.every(($,J,Z)=>J===0?!0:Z[J-1].percent>$.percent))return"Milestones should be in order (from high to low)";return""},JX=(Q,X,W)=>{const $=ZX(Q.tracker,X,W),J=Q.levels.length-1;let Z=0,Y=0,G=0,U=0,_=0,B=0;return $.forEach((P,K)=>{if(Z+=P.level.code>-1?1:0,Y+=P.level.code>0?1:0,G+=P.level.code>0?P.level.code:0,K===$.length-1)return;const N=P.level.code<1;B=N?B+1:0;const E=100*((P.level.code>0?P.level.code:0)/(Q.levels.length-1));U=Math.round(E)>50?U+1:0,_=N?0:_+1}),{title:Q.title,aceStreak:U,followStreak:_,missed:B,percent:Math.round(100*(G/(Z*J))),totalDays:Z,workingDays:Y}},T0=(Q,X,W)=>{const $=!!Q.length;if(!$)return{hideAddButton:!1,hideRemoveButton:X.length<3};const J=X[W],Z=!!($&&Q.find((K)=>K.name===J.name)),Y=Q.length!==X.length,G=X.length<Q.length,U=X.length>Q.length,_=!Y&&Q.length&&Q.some((K,j)=>K.name!==X[j].name);return{hideAddButton:G||_||Z&&G,hideRemoveButton:G||_||Z&&U}},H0=(Q,X,W)=>{const $=!!Q.length,J=X[W],Z=!!($&&Q.find((G)=>G.name===J.name)),Y=Q.length!==X.length;return Z&&Y},w0=(Q,X,W,$=!1)=>{const J=aQ[W],Z=Q/(X-1),G=Math.trunc(Math.pow(Z,P0)*255).toString(16),U=G.length===1?`0${G}`:G,_=Q<0||U==="0"?"transparent":`${J}${U}`,B=$?Q/(X-1)>0.5?"white":"black":Q<0?"lightgray":"transparent";return{backgroundColor:_,fontColor:B,peakBackgroundColor:J,levelPercent:Math.round(Z*100)}},x0=(Q,X)=>{const W=[];for(let $ of X)if(!Q.some((Z)=>{if(NQ(Z.date,$))return W.push(Z),!0;return!1}))W.push(A0($));return W},ZX=(Q,X,W)=>{const $=R0(X,W);return x0(Q,$)},f0=(Q)=>{const X=new Date,W=new Date(Q),$=-G0(W);if($===0)return"Just created this habit today";if($===1)return"This habit started from yesterday";if($>1&&$<5)return`Started following this ${$} back`;const{aceStreak:J,followStreak:Z,missed:Y}=JX(i0(Q),eQ(X,-$),X);if(J>=12)return`Nailed ${J} days in a row. Woah! Don't stop.`;if(J>=4)return`Doing good for ${J} days straight! Keep it up.`;if(Z>=15)return`Didn't miss for ${Z} days in a row. Kudos!`;if(Z>=4)return`${Z} days in a row. Nice! keep going.`;if(Y)`Missed ${Y} days. Impossible is I M Possible.`;return"Just stick to it. Patience is the key."},S0=(Q,X,W)=>{if(!Q.length||Q.length===X.length)return W;const $=[...W],J=[];return Q.forEach((Z,Y)=>{const G=X.find((P)=>P.name===Z.name),U=!G,_=(P)=>{const K=[];W.forEach((j,N)=>{if(j.level.code===Z.code)K.push(N)}),J.push({indices:K,newLevel:P})};if(U){if(Y===Q.length-1)_(X[X.length-1]);return}if(G.code===Z.code)return;_(G)}),J.forEach((Z)=>{Z.indices.forEach((Y)=>{$[Y]={...$[Y],level:Z.newLevel}})}),$},LQ=(Q)=>{const X=Q.length-1;for(let W=0;W<Q.length;W++)Q[W]={...Q[W],code:W,isMaxLevel:W===X};return Q},L0=(Q)=>[{label:"Today",icon:"calendar_month",isSelected:Q==="/",href:"/"},{label:"Habits",icon:"checklist",isSelected:Q==="/habits/",href:"/habits/"},{label:"Settings",icon:"settings",isSelected:Q==="/settings/",href:"/settings/"}],I0=()=>{if(window.navigator?.vibrate)window.navigator.vibrate(3)},MQ=(Q,X,W)=>{const $=JSON.parse(Q||"{}"),J=$&&typeof $==="object",Z=$[X];if(!J||!(W?Z===W:!!Z))return;return $},S=(Q)=>{return(...X)=>{return I0(),r0(new Date),Q&&Q(...X)}},YX="analytics",V0="id",y0="analytics",qX=(Q)=>{localStorage.setItem(YX,JSON.stringify(Q))},g0=()=>{if(!y.currentIs("run"))return fQ;const Q=()=>{const $=localStorage.getItem(YX);return MQ($,V0,y0)};if(!Q())qX(fQ);const W=Q();if(!W)throw"Error fetching analytics";return W},C0=()=>{const Q=[];for(let X in localStorage){if(!localStorage.hasOwnProperty(X))continue;Q.push(X)}return Q},b0=(Q)=>Q.startsWith("h."),kQ=(Q)=>`h.${Q}`,zX=(Q)=>{if(!b0(Q))return;const X=localStorage.getItem(Q),W=MQ(X,"title");if(!W)return;return W},h0=()=>{if(!y.currentIs("run"))return[];const Q=[];for(let X of C0()){const W=zX(X);if(!W)continue;Q.push(W)}return Q},v0=(Q)=>{const X=kQ(Q.id);localStorage.setItem(X,JSON.stringify(Q))},c0=(Q)=>{const X=kQ(Q);localStorage.removeItem(X)},GX="settings",m0="id",p0="local-settings",UX=(Q)=>{localStorage.setItem(GX,JSON.stringify(Q))},u0=()=>{if(!y.currentIs("run"))return $Q;const Q=()=>{const $=localStorage.getItem(GX);return MQ($,m0,p0)};if(!Q())UX($Q);const W=Q();if(!W)throw"Error fetching settings";return d0(W),Q()},d0=(Q)=>{if(!Q.editPage)UX({...Q,editPage:$Q.editPage})},r0=(Q)=>{const X=g0();qX({...X,lastInteraction:Q.getTime()})},o0=()=>{return u0().editPage},i0=(Q)=>{const X=kQ(Q),W=zX(X);if(!W)throw`Error fetching habit with id '${Q}' from storage`;return OQ(W)},s0=(Q)=>{const W=h0().find(($)=>$.title.trim()===Q.trim());return W?OQ(W):void 0},RX=(Q)=>{const X=O0(Q);v0(X)},n0=(Q)=>{const X={...Q,isStopped:!0};RX(X)},l0=(Q)=>c0(Q),a0=O(({cssClasses:Q,hideRemove:X,hideAdd:W,onRemove:$,onAdd:J})=>{const Z=w(X).and(W).ternary("bn","ba"),Y=F`br3 pb1 f4 bw1 b--light-silver dark-gray ${Z} ${Q}`,G=w(W).ternary("","br"),U=F`pointer ph2 pb1 bw1 b--light-silver ${G}`,_=()=>D(Z,Y,G,U);return q.Span({onunmount:_,class:Y,children:[q.If({subject:X,isFalsy:()=>q.Span({class:U,onclick:S($),children:"-"})}),q.If({subject:W,isFalsy:()=>q.Span({class:"pointer ph2 pb1",onclick:S(J),children:"+"})})]})}),p=O(({cssClasses:Q,onTap:X,onUnmount:W,children:$})=>{const J=F`pointer noselect br-pill ba bw1 b--light-silver b--hover-black bg-white black ${Q}`,Z=()=>{if(D(J),W)W()};return q.Button({onunmount:Z,class:J,onclick:S(()=>X()),children:$})}),F1=O(({cssClasses:Q})=>{const X=F`bb b--light-gray ${Q}`;return q.Div({onunmount:()=>D(X),class:X})}),b=O(({cssClasses:Q,size:X,onClick:W,iconName:$,title:J})=>{const Y=F`material-symbols-outlined ${W?"pointer":""} ${Q}`,G=T(X).or(16),U=F`font-size: ${G}px`;return q.Span({onunmount:()=>D(Y,G,U),class:Y,style:U,onclick:S(W),children:$,title:J})}),IQ=O(({cssClasses:Q,href:X,target:W,onClick:$,children:J})=>{const Z=w(X).or($).ternary("pointer underline",""),Y=F`w-fit-content noselect ${Z} ${Q}`;return q.A({onunmount:()=>D(Z,Y),...X?{href:X}:{},class:Y,target:W,onclick:S($),children:J})}),YQ=O(({cssClasses:Q,isOpen:X,content:W,onTapOutside:$,onUnmount:J})=>{const Z=F`pa0 br3 ${Q}`,Y=(U)=>{setTimeout(()=>n(()=>{if(X.value)U.showModal();else U.close()}))},G=()=>{if(D(Z),J)J()};return q.Dialog({onmount:Y,onunmount:G,onclick:S($),class:Z,children:[q.Div({onclick:(U)=>U.stopPropagation(),children:W})]})}),t0=O(({cssClasses:Q,placeholder:X,num:W,onchange:$})=>{const J=T(W).string,Z=(Y)=>{const G=Y.target.value,U=Number.parseFloat(Number.parseFloat(G||"0").toFixed(2));$(U)};return q.Input({onunmount:()=>D(J),class:Q,type:"number",placeholder:X,value:J,onchange:Z})}),e0=O(({progress:Q,cssClasses:X})=>{const W=F`br-pill bg-moon-gray ${X}`,$=F`width: ${T(Q).toConfined(0,100)}%;`;return q.Div({onunmount:()=>D(W,$),class:W,children:q.Div({class:"br-pill bg-app-theme-color pa1",style:$})})}),_X=O(({cssClasses:Q,header:X,content:W,bottombar:$})=>{const J=F`w6-ns ${Q}`;return q.Div({onunmount:()=>D(J),class:"flex-ns justify-center-ns",children:q.Div({class:J,children:[q.If({subject:X,isTruthy:()=>q.Div({class:"overflow-break-word sticky top-0 left-0 right-0 bg-inherit z-999 f2dot33 b pv3 mt2",children:X})}),W,q.Div({class:"pv6 mt5"}),q.If({subject:$,isTruthy:()=>q.Div({class:"sticky bottom-0 left-0 right-0 z-9999",children:$})})]})})}),K1=O(({cssClasses:Q,tabs:X,onTabChange:W})=>{const $=F`bg-white br3 ${Q}`,J=T(X).map((Z)=>{return{tabClasses:`
                w-100 br3 pv2dot5 ph2 flex justify-center noselect br-pill ba bw1 bg-inherit
                ${Z.isSelected?`b--light-silver b black ${Z.classes||""}`:"pointer b--transparent b--hover-black silver pointer"} ${Z.classes}`,label:Z.label}});return q.Div({onunmount:()=>D($,J),class:$,children:q.Div({class:"flex items-center justify-between pa1",children:q.For({subject:J,itemKey:"label",map:(Z,Y)=>{const{tabClasses:G,label:U}=T(Z).props;return q.Span({onunmount:()=>D(G,U),onclick:S(()=>W(Y.value)),class:G,children:U})}})})})}),VQ=O(({cssClasses:Q,placeholder:X,disabled:W,text:$,onmount:J,onchange:Z,onkeydown:Y,onfocus:G,onblur:U})=>{let _;const B=w(W).truthy,P=(N)=>{if(_=N,J)J(N)},K=(N)=>{const H=N.target.value;if(Z)Z(H)},j=(N)=>{const H=N.key.length===1?_.value+N.key:N.key==="Backspace"?_.value.slice(0,-1):_.value,E={key:N.key,text:H};if(Y)Y(E)};return q.Input({onmount:P,onunmount:()=>D(B),class:Q,type:"text",placeholder:X,disabled:B,value:$,onchange:K,onkeydown:j,onfocus:G,onblur:U})}),P1=O(({cssClasses:Q,isOn:X,onToggle:W})=>{const $=F`flex items-center pointer noselect br-pill ba bw1dot5 b--mid-gray b--hover-black bg-white pa05 black ${Q}`,Z=F`${"br-100 ba bw1 b--hover-black pa1"} ${()=>X.value?"b--transparent":"b--moon-gray bg-moon-gray"}`,Y=F`${"br-100 ba bw1 b--hover-black pa1"} ${()=>X.value?"b--mid-gray bg-mid-gray":"b--transparent"}`;return q.Div({onunmount:()=>D($,Z,Y),class:$,onclick:S(W),children:[q.Div({class:Z}),q.Div({class:"pa05"}),q.Div({class:Y})]})}),Q1=O(({cssClasses:Q,justifyCssClasses:X,label:W})=>{const $=T(X).or("justify-end"),J=T(W).or("Add habit"),Z=F`w-100 flex ${$} ${Q}`;return q.Div({onunmount:()=>D($,J,Z),class:Z,children:p({cssClasses:"pa3 mb3 shadow-4 b flex items-center",children:[b({cssClasses:"nl1 mr1",size:22,iconName:"add"}),J],onTap:F0})})}),qQ=O(({cssClasses:Q,dotCssClasses:X,colorIndex:W,level:$,totalLevels:J,showText:Z,textContent:Y,icon:G,iconSize:U,isRectangular:_,showHeight:B,onClick:P})=>{const K=w(_).ternary("br0","br-100"),j=w($).isLT(0).ternary("bg-transparent","bg-light-gray"),N=C(w0,$,J,W,Z),{peakBackgroundColor:H,backgroundColor:E,fontColor:x,levelPercent:L}=T(N).props,I=T(Y).or("\u0387"),g=w(B).and(G).andThisIsGT(L,99).truthy,c=F`pointer relative overflow-hidden ${K} ${j} ${Q}`,d=F`flex items-center justify-around absolute left-0 right-0 bottom-0 br0 ${X}`,s=F`
      background-color: ${H};
      color: white;
      height: ${L}%;`,a=F`flex items-center justify-around absolute absolute--fill ${X}`,t=F`
      background-color: ${E};
      color: ${x};`,k=()=>{if(P&&$.value>=0)P()},A=()=>{D(K,j,N,H,E,x,L,I,g,c,d,s,a,t)};return q.Span({onunmount:A,class:c,onclick:S(k),children:q.If({subject:B,isTruthy:()=>q.Span({class:d,style:s,children:q.If({subject:g,isTruthy:()=>b({iconName:G,size:U})})}),isFalsy:()=>q.Span({class:a,style:t,children:q.If({subject:G,isTruthy:(f)=>b({iconName:f,size:U}),isFalsy:()=>q.Span(I)})})})})}),j1=O(({habit:Q,day:X,onColorDotClick:W})=>{const{id:$,title:J,colorIndex:Z,levels:Y,tracker:G}=T(Q).props,U=T(Y).length,_=R(()=>{return $X(G.value,X.value).level.code}),B=w(_).isGT(0).truthy,P=w(_).isLT(1).ternary("b--light-silver","b--transparent"),K=F`pa3 mr3 ba b ${P}`,j=()=>D($,J,Z,Y,G,U,_,B,P);return q.Div({onunmount:j,class:"mt4 flex items-center",children:[qQ({cssClasses:K,colorIndex:Z,level:_,totalLevels:U,icon:"check",iconSize:22,showText:B,showHeight:!0,onClick:W}),q.Div({class:"pointer",onclick:S(()=>K0($.value)),children:[q.Div({class:"f5 fw6 f4-ns fw4-ns",children:J}),q.Div({class:"f6 light-silver pt05",children:f0($.value)})]})]})}),X1=O(({cssClasses:Q})=>{const X=F`pa3 flex items-center ${Q}`;return p({onUnmount:()=>D(X),cssClasses:X,children:[b({iconName:"arrow_back"}),q.Span({class:"ml1",children:"Go Back"})],onTap:()=>history.back()})}),A1=O(({cssClasses:Q,milestones:X,achievedMilestone:W,completionPercent:$})=>{const J=T(W).prop("color"),Z=C((K)=>K>53?"Average completion":K>43?"Avg completion":K>35?"Completion":"",$),Y=F`center ${Q}`,G=F`nt3dot6 h1dot2 bw1 relative br b--${J}`,U=F`width: ${$}%;`,_=F`absolute right-0 pr1 b f6 ${J}`,B=F`${$}%`,P=()=>D(J,Z,Y,G,U,_,B);return q.Div({onunmount:P,class:Y,children:[q.Div({class:"pb2 w-100 relative",children:q.For({subject:X,map:(K,j)=>{return $1({colorCss:`bg-${K.color}`,percent:K.upperLimit,hideUpperLimit:j===0})}})}),q.Div({class:G,style:U,children:q.Div({class:"relative flex items-start nt1 justify-between f7 mid-gray",children:[q.Div(Z),q.Div({class:_,children:B})]})})]})}),$1=O(({colorCss:Q,hideUpperLimit:X,percent:W})=>{const $=w(X).ternary("",F`${W}%`),J=F`width: ${W}%;`,Z=F`absolute absolute-fill h0dot15 w-100 ${Q}`;return q.Div({onunmount:()=>D($,J,Z),class:"absolute flex items-start h0dot5 bl br b--light-silver bw1",style:J,children:[q.Div({class:Z}),q.Div({class:"flex justify-end w-100 pt2 f7",children:q.Div({class:"nr3 pb2 light-silver b",children:$})})]})}),W1=O(({cssClasses:Q,habit:X,date:W,colorIndex:$,totalLevels:J})=>{const Z=R(()=>{const _=W.value.getFullYear(),B=W.value.getMonth(),P=new Date(_,B,1),K=new Date(_,B+1,0);return ZX(X.value.tracker,P,K).map((j)=>({...j,level:j.level.code}))}),Y=F`flex items-center ${Q}`,G=R(()=>Y0(W.value.getMonth(),3)),U=()=>D(Z,Y,G);return q.Div({onunmount:U,class:Y,children:[q.Div({class:"f8 b w2 light-silver",children:G}),q.Div({class:"w-100 flex items-center justify-between",children:q.For({subject:Z,itemKey:"key",map:(_)=>{const B=T(_).prop("level");return qQ({cssClasses:"pa1",colorIndex:$,level:B,totalLevels:J})}})})]})}),N1=O(({cssClasses:Q,habit:X,months:W,onClick:$})=>{const{milestones:J,title:Z,colorIndex:Y,levels:G}=T(X).props,U=C((x,L)=>{const{startDate:I,endDate:g}=_0(x);return JX(L,I,g).percent},W,X),_=C(WX,J,U),{icon:B,color:P}=T(_).props,K=C((x)=>U0(x).map((L)=>({monthFirstDate:L,index:L.getTime()})),W),j=F`pointer bg-white ${Q}`,N=F`mr1 ${P}`,H=F`${U}%`,E=()=>{D(J,Z,Y,G,U,_,B,P,K,j,N,H)};return q.Div({onunmount:E,class:j,onclick:S($),children:[q.Div({class:"flex items-center justify-between nt1 mb2",children:[q.Div({class:"f5 dark-gray b",children:Z}),q.Div({class:"f6 silver b flex items-center",children:[b({cssClasses:N,iconName:B}),H]})]}),q.Div({class:"mt2 mb1",children:q.For({subject:K,itemKey:"index",map:(x)=>{return W1({cssClasses:"mb1",habit:X,date:T(x).prop("monthFirstDate"),colorIndex:Y,totalLevels:G.value.length})}})})]})}),O1=O(({cssClasses:Q})=>{const X=F`flex flex-column items-center justify-around ${Q}`;return q.Div({onunmount:()=>D(X),class:X,children:[q.Img({class:"mt3 pt4",src:"/assets/images/just_landed.png",height:"200"}),q.Div("Looks like, you just landed here!"),Q1({cssClasses:"pt5",justifyCssClasses:"justify-around",label:"Add your first habit"})]})}),J1=O(({isOpen:Q,habit:X,onClose:W,onDone:$})=>{const J=F`Delete '${()=>X.value.title}'?`,Z=()=>{l0(X.value.id),$()};return YQ({onUnmount:()=>D(J),cssClasses:"bn w-30-ns",isOpen:Q,onTapOutside:W,content:q.Div({class:"pa3 f5",children:[q.Div({class:"mb3 b f4",children:J}),q.Div({class:"mb4",children:[`
              All the data and the achievements associated with this habit will be lost forever
              with this action, and cannot be reversed.
              `,q.Br({}),q.Br({}),`
              Are you sure, you want to DELETE this habit permanently?
              `]}),q.Div({class:"flex items-center justify-between f6",children:[p({cssClasses:"w-25 pv2 ph3 mr1 b",children:"No",onTap:W}),p({cssClasses:"pv2 ph3 ml2 b red",children:"Yes, delete permanently",onTap:Z})]})]})})}),M1=O(({isOpen:Q,habit:X,date:W,showTitleInHeader:$,onClose:J,onChange:Z})=>{const{title:Y,levels:G,tracker:U,colorIndex:_}=T(X).props,B=R(()=>$?.value?`Change status of  '${Y.value}'`:`Change status for ${W.value.toDateString()}`),P=C($X,U,W),K=T(G).length,j=R(()=>{const H=[...G.value];return H.reverse(),H.map((E,x)=>{const L=K.value-1-x,g=`pointer flex items-center pv3 pa3 bt b--moon-gray ${P.value?.level.code===L?"bg-near-white black fw6":"gray fw5"}`,d=`pa1 mr3 ba b ${L<1?"b--light-silver":"b--transparent"}`;return{levelName:E.name,levelCode:L,levelTileCSS:g,dotClasses:d}})});return YQ({onUnmount:()=>D(Y,G,U,_,B,P,K,j),cssClasses:"f5 normal ba bw0 outline-0",isOpen:Q,onTapOutside:J,content:q.Div({class:"mnw5",children:[q.Div({class:"f5 b tc pa3",children:B}),q.Div({class:"f5 mb1",children:q.For({subject:j,map:(H)=>{const{levelName:E,levelCode:x,levelTileCSS:L,dotClasses:I}=T(H).props;return q.Div({onunmount:()=>D(E,x,L,I),class:L,onclick:S(()=>Z(x.value)),children:[qQ({cssClasses:I,colorIndex:_,level:x,totalLevels:G.value.length,isRectangular:!0}),q.Span(E)]})}})})]})})}),Z1=O(({isOpen:Q,habit:X,onClose:W,onDone:$})=>{const J=F`Stop '${()=>X.value.title}'?`;return YQ({onUnmount:()=>D(J),cssClasses:"bn",isOpen:Q,onTapOutside:W,content:q.Div({class:"pa3 f5",children:[q.Div({class:"mb3 b f4",children:J}),q.Div({class:"mb4",children:["This action is not reversible. You will not be able to resume it again.",q.Br({}),q.Br({}),"Are you sure, you want to STOP this habit permanently?"]}),q.Div({class:"flex items-center justify-between f6",children:[p({cssClasses:"w-100 pv2 ph3 mr2",children:"No, go back",onTap:W}),p({cssClasses:"w-100 pv2 ph3 ml2 b",children:"Yes, stop this",onTap:$})]})]})})}),Y1=O(({cssClasses:Q,links:X})=>{const W=F`flex items-center justify-between pv3 bg-near-white ${Q}`;return q.Div({onunmount:()=>D(W),class:W,children:q.For({subject:X,map:($)=>q1({label:$.label,icon:$.icon,isSelected:$.isSelected,href:$.href})})})}),q1=O(({cssClasses:Q,label:X,icon:W,isSelected:$,href:J})=>{const Z=w($).ternary("app-theme-color b","black"),Y=F`pointer noselect flex flex-column items-center justify-center pb2 ${Z} ${Q}`;return q.Div({onunmount:()=>D(Z,Y),class:Y,onclick:S(()=>B0(J.value)),children:[b({size:22,iconName:W}),q.Div({class:"f7",children:X})]})}),k1=O(({cssClasses:Q,header:X,content:W,navbarTop:$,route:J})=>{return _X({cssClasses:Q,header:X,content:W,bottombar:q.Div({children:[q.If({subject:$,isTruthy:()=>$}),Y1({cssClasses:"nl3 nr3 ph4",links:C(L0,J)})]})})}),z1=O(({cssClasses:Q,body:X,onMount:W,onUnMount:$})=>{const J=V("stylesheet");return q.Html({lang:"en",children:[q.Head({onmount:()=>J.value="stylesheet",children:[q.Meta({"http-equiv":"Content-Security-Policy",content:`
                default-src 'self';
                script-src 'self';
                style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://unpkg.com;
                font-src https://fonts.gstatic.com;
                object-src 'none';
                base-uri 'none';
              `}),q.Meta({charset:"UTF-8"}),q.Meta({"http-equiv":"X-UA-Compatible",content:"IE=edge"}),q.Meta({name:"viewport",content:"width=device-width, initial-scale=1.0"}),q.Link({rel:"icon",type:"image/x-icon",href:"/assets/images/favicon.ico"}),q.Link({rel:J,href:"/assets/styles.css",as:"style"}),q.Link({rel:"manifest",href:"/manifest.json"}),q.Title("Habits (by Cyfer)")]}),q.Body({tabindex:"-1",class:Q,onmount:W,onunmount:$,children:[q.Script({src:"main.js",defer:!0}),X]})]})}),r=O(({cssClasses:Q,contentCssClasses:X,title:W,description:$,hideDescription:J,children:Z})=>{const Y=F`mt3 mb4 ${Q}`,G=w($).andNot(J).truthy;return q.Div({onunmount:()=>D(Y,G),class:Y,children:[q.Div({class:"mb2 dark-gray f4 b",children:W}),q.If({subject:G,isTruthy:()=>q.Div({class:"mb3 f6 silver fw5",children:$})}),q.Div({class:X,children:Z})]})}),D1=O(({cssClasses:Q,iconSize:X,selectedOptionIndex:W,onChange:$})=>{const J=V(!1),Z=R(()=>SQ[W.value]),Y=T(Z).prop("decending"),G=T(Z).prop("icon"),U=T(X).or(20),_=()=>J.value=!0,B=()=>J.value=!1,P=(j)=>j===Z.value.label?"bg-near-white black fw6":"gray fw5",K=(j)=>{$(j),B()};return q.Div({onunmount:()=>D(Z,Y,G,U),class:Q,children:[yQ({cssClasses:"pointer",descending:Y,iconName:G,size:U,onClick:_}),YQ({cssClasses:"f5 normal ba bw0 outline-0",isOpen:J,onTapOutside:B,content:q.Div({children:[q.Div({class:"f5 b tc pv3",children:"Sort habit cards by"}),q.Div({class:"f5 mb1",children:q.For({subject:SQ,map:(j,N)=>q.Div({class:`pointer flex items-center pv3 pl2 pr3 bt b--moon-gray ${P(j.label)}`,onclick:S(()=>K(N)),children:[yQ({cssClasses:"ml1 mr2",descending:j.decending,iconName:j.icon,size:20}),q.Span(j.label)]})})})]})})]})}),yQ=O(({cssClasses:Q,descending:X,iconName:W,size:$,onClick:J})=>{const Z=J?"pointer":"",Y=w(X).ternary("arrow_upward","arrow_downward"),G=w($).mul(4).div(5).result;return q.Span({class:F`flex items-center ${Z} ${Q}`,onclick:S(J),children:[b({cssClasses:"silver",iconName:Y,size:G}),b({size:$,iconName:W})]})}),E1=O(({cssClasses:Q,progress:X})=>{const W=F`flex flex-column justify-center items-center vh-100 ${Q}`;return q.Div({onunmount:()=>D(W),class:W,children:[q.Img({class:"mt6 br4",src:"/assets/images/habits-logo.png",height:"100",width:"100"}),q.Div({class:"f3 b mv3",children:"Habits"}),e0({cssClasses:"w-40",progress:X}),q.Div({class:"mt7 pv4",children:"A Cyfer Product"})]})}),T1=O(({date:Q,selectedDate:X,onChange:W})=>{const $=C(q0,Q),J=C(NQ,X,Q),Z=w($).ternary("light-gray b--transparent","light-silver pointer b--transparent"),Y=w(J).ternary("black b b--silver",Z),G=F`bw1 ba br-pill ph2 pv3 pb2 tc ${Y}`,U=R(()=>tQ(Q.value.getDay(),3)),_=R(()=>("0"+Q.value.getDate()).slice(-2)),B=()=>{if(J.value||$.value)return;W(Q.value)},P=()=>D($,J,Z,Y,G,U,_);return q.Div({onunmount:P,class:G,onclick:S(B),children:[q.Div({class:"f7 ",children:U}),q.Div({class:"mt2 f4",children:_})]})}),G1=O(({cssClasses:Q,editableHabit:X,editedHabit:W,hideDescriptions:$,showFullCustomisations:J,onChange:Z})=>{const Y=V(!1),G=T(J).or(Y),{title:U,frequency:_,levels:B,milestones:P,colorIndex:K}=T(W).props,j=T(_).every((k)=>!!k),E=w(j).ternary("bg-mid-gray white","bg-near-white light-silver"),x=w(Y).ternary("remove","add"),L=F`Show ${w(Y).ternary("Less","More")} Customisations`,I=(k)=>{Z({...W.value,title:k})},g=(k)=>{Z({...W.value,colorIndex:k})},c=(k)=>{if(k<-1||k>6)throw"Invalid day index";if(k===-1){Z({...W.value,frequency:[1,1,1,1,1,1,1]});return}const A=j.value?_.value.map((f)=>0):_.value;A[k]=j.value?1:A[k]?0:1,Z({...W.value,frequency:A})},d=(k,A)=>{const f=B.value;f[A]={...f[A],name:k},Z({...W.value,levels:f})},s=(k)=>{const A=B.value;A.splice(k,0,{isMaxLevel:!1,name:"",code:k}),Z({...W.value,levels:LQ(A)})},a=(k)=>{const A=B.value;if(A.length<3)return;A.splice(k,1),Z({...W.value,levels:LQ(A)})},t=(k,A)=>{if(A<0||A>2)throw"Incorrect index of milestone passed. Milestone values should not be more than 3.";const f=[...W.value.milestones];f[A]={...f[A],percent:k},Z({...W.value,milestones:f})};return q.Div({class:Q,children:[r({cssClasses:"pb1",title:"Weekdays",children:q.Div({class:"mb3 f6 flex items-center justify-between justify-start-ns",children:q.For({subject:Array(7).fill(0),n:0,nthChild:q.Span({class:F`pointer flex items-center justify-center br-pill h2 ph2 mr3-ns ${E}`,children:"Daily",onclick:S(()=>c(-1))}),map:(k,A)=>{const f=R(()=>_.value[A]&&!j.value?"bg-mid-gray white":"bg-near-white light-silver");return q.Span({class:F`pointer flex items-center justify-center br-100 h2 w2 mr3-ns ${f}`,children:tQ(A,1),onclick:S(()=>c(A))})}})})}),r({cssClasses:"pb2",title:"Title of the habit",children:VQ({cssClasses:"ba bw1 b--light-silver br3 pa2 w-100",placeholder:'for example, "wake up at 5am"',text:U,onchange:I})}),q.If({subject:G,isTruthy:()=>q.Div([r({cssClasses:"pb1",title:"Select a color tag",children:q.Div({class:"mb1 flex items-center",children:q.For({subject:aQ,map:(k,A)=>{const f=w(K).equals(A).ternary("#999","#f4f4f4");return q.Span({class:"pointer mb2 mr3 pa1 br-100 bw2 ba flex",style:F`border-color: ${f}`,onclick:S(()=>g(A)),children:q.Span({class:F`pa2 br-100`,style:`background-color: ${k}`})})}})})}),r({cssClasses:"pb3",title:"Status update levels",hideDescription:$,description:`
                  When updating a habit status in a day, we generally have only two levels - "${BQ[0]}"
                  or "${BQ[1]}". But a habit can have more than 2 levels as well.
                  Like for example, the habit of 'Drink 2 litres water daily'
                  should ideally have three levels - '0 litre', '1 litre' and '2 litres', from low to high.
                  You can add or remove levels by clicking on + or - buttons. Click on textbox
                  for editing the status level name. The levels from top to bottom should go from lowest
                  to the highest.`,children:q.For({subject:B,map:(k,A)=>{const f=X?.value?.levels||[],DQ=B.value,{hideAddButton:BX,hideRemoveButton:FX}=T0(f,DQ,A),KX=H0(f,DQ,A);return q.Div({children:[q.Div({class:"flex items-center justify-between",children:[q.Div({class:"flex items-center ba bw1 b--light-silver br3 w-70 w-80-ns",children:[qQ({cssClasses:"w1 h2 br3 br--left ml1px",dotCssClasses:"br3 br--left",colorIndex:K,level:A,isRectangular:!0,totalLevels:B.value.length}),VQ({cssClasses:"bn pa2 br3 w-100 outline-0",placeholder:`Level ${A}`,disabled:KX,text:k.name,onchange:(PX)=>d(PX,A)})]}),a0({hideAdd:BX,hideRemove:FX,onAdd:()=>s(A+1),onRemove:()=>a(A)})]}),q.If({subject:w(B).lengthGT(A+1).truthy,isTruthy:()=>q.Div({class:"pa2 ml2 pl1 bl bw1 b--silver"})})]})}})}),r({title:"Habit completion goal",hideDescription:$,description:F`
                  Goals are something for long-term. Let's say based on below table, after
                  a month or two, you followed your habit for 67% of the times, then you
                  just crossed the milestone - '${()=>WX(W.value.milestones,67).label}'. For achieving your goal (in %), you can set your
                  own custom milestones depending on the difficulty of the habit.`,children:q.For({subject:P,n:0,nthChild:q.Div({class:"mb1 ph2 pv0 bn bw1 relative ts-white-1",children:[q.Span({class:"lh-copy",children:""}),q.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[q.Span({class:"w-100 bg-white bn bw1 ph2dot5 di f4 b light-silver pb3 nl1",children:"100"}),q.Span({class:"ph2 bg-white light-silver b pb3 mr1",children:"%"})]})]}),map:(k,A)=>q.Div({class:"mb1 ph4 pv4 ba br3 bw1 b--light-gray relative",children:[q.Span({class:"lh-copy flex items-center",children:[b({cssClasses:`mr2 ${k.color}`,size:20,iconName:k.icon}),k.label]}),q.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[q.If({subject:A===3,isTruthy:()=>q.Span({class:"w-100 bg-white bn bw1 br3 pa2dot5 di f4 b light-silver mb1",children:"00"}),isFalsy:()=>t0({cssClasses:"w-100 ba bw1 b--light-silver br3 pa2dot5 di f5 b dark-gray",num:k.percent,onchange:(f)=>t(f,A)})}),q.Span({class:"ph2 bg-white light-silver b",children:"%"})]})]})})})])}),q.If({subject:J,isFalsy:()=>p({cssClasses:"pv2 ph3 flex items-center",onTap:()=>Y.value=!Y.value,children:[b({cssClasses:"mr1",iconName:x}),L]})})]})}),U1=O(({editableHabit:Q,onMount:X})=>{const W=V($Q.editPage),$=V(!1),J=V(!1),Z=V(""),Y=V(M0()),G=C((I)=>I?`Edit '${I.title}'`:"Add new habit",Q),U=w(G).lengthGT(22).ternary("f2dot66",""),_=w(Q).ternary("Update","Add"),B=()=>$.value=!0,P=()=>$.value=!1,K=()=>{P(),history.go(-2)},j=()=>J.value=!0,N=()=>J.value=!1,H=()=>{n0(Y.value),N(),history.back()},E=(I)=>Y.value=I,x=()=>{if(Z.value=E0(Y.value,!Q?.value),Z.value)return;const I=Y.value,g=[...Q?.value?.levels||[]],c=S0(g,I.levels,I.tracker);RX({...Y.value,tracker:c}),history.back()};return z1({onMount:()=>{if(X)X(),Y.value=Q?.value;W.value=o0()},body:_X({cssClasses:"bg-white ph3",header:q.Div({class:U,children:G}),content:q.Div([q.If({subject:Q,isTruthy:()=>q.Div([r({cssClasses:"pb2",title:"Actions",children:[J1({isOpen:$,habit:Y,onClose:P,onDone:K}),IQ({cssClasses:"db mb3 f6 red",children:"Delete this habit permanently along with its data",onClick:B}),Z1({isOpen:J,habit:Y,onClose:N,onDone:H}),IQ({cssClasses:"db mb3 f6 gray",children:"Stop this habit permanently and keep it for future",onClick:j})]})])}),G1({editableHabit:Q,editedHabit:Y,hideDescriptions:R(()=>!W.value.showHints),showFullCustomisations:T(W).prop("showFullCustomisation"),onChange:E})]),bottombar:q.Div({class:"bg-white w-100 pv3",children:[q.If({subject:Z,isTruthy:()=>q.Div({class:"red mb3",children:Z})}),q.Div({class:"flex items-center justify-stretch",children:[X1({cssClasses:"w4dot50 w4dot25-ns"}),p({cssClasses:"w-100 pa3 ml3 b",children:_,onTap:x})]})]})})})}),R1=U1({}),_1=()=>{y.start("mount"),vQ.resetIdCounter(),R1(),y.start("run")};_1();
